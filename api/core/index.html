<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://t03i.github.io/FlatProt/api/core/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Core - FlatProt</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Core";
        var mkdocs_page_input_path = "api/core.md";
        var mkdocs_page_url = "/FlatProt/api/core/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/json.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/toml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/numpy.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> FlatProt
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../installation/">Installation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../examples/">Examples</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Commands</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../commands/project/">Project</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../commands/align/">Align</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../commands/overlay/">Overlay</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../commands/split/">Split</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">File Formats</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../file_formats/matrix/">Matrix Files</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../file_formats/style/">Style Files</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../file_formats/annotations/">Annotation Files</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tools</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tools/matrix_extraction/">PyMOL Matrix Extraction</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../io/">IO</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Core</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#structure-representation">Structure Representation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.Structure">Structure</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.Structure.coordinates">coordinates</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.Structure.residues">residues</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.Structure.__contains__">__contains__</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.Structure.__getitem__">__getitem__</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.Structure.__init__">__init__</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.Structure.__iter__">__iter__</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.Structure.__len__">__len__</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.Structure.apply_vectorized_transformation">apply_vectorized_transformation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.Structure.get_coordinate_at_residue">get_coordinate_at_residue</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.Structure.items">items</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.Structure.values">values</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.Structure.with_coordinates">with_coordinates</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#coordinate-and-range-types">Coordinate and Range Types</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.coordinates">coordinates</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.coordinates.ResidueCoordinate">ResidueCoordinate</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#flatprot.core.coordinates.ResidueCoordinate.from_string">from_string</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.coordinates.ResidueRange">ResidueRange</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#flatprot.core.coordinates.ResidueRange.__contains__">__contains__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#flatprot.core.coordinates.ResidueRange.__eq__">__eq__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#flatprot.core.coordinates.ResidueRange.__iter__">__iter__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#flatprot.core.coordinates.ResidueRange.__len__">__len__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#flatprot.core.coordinates.ResidueRange.__lt__">__lt__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#flatprot.core.coordinates.ResidueRange.from_string">from_string</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#flatprot.core.coordinates.ResidueRange.is_adjacent_to">is_adjacent_to</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.coordinates.ResidueRangeSet">ResidueRangeSet</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#flatprot.core.coordinates.ResidueRangeSet.__contains__">__contains__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#flatprot.core.coordinates.ResidueRangeSet.__eq__">__eq__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#flatprot.core.coordinates.ResidueRangeSet.__iter__">__iter__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#flatprot.core.coordinates.ResidueRangeSet.__len__">__len__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#flatprot.core.coordinates.ResidueRangeSet.from_string">from_string</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#flatprot.core.coordinates.ResidueRangeSet.is_adjacent_to">is_adjacent_to</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#core-errors">Core Errors</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.errors">errors</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.errors.CoordinateCalculationError">CoordinateCalculationError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.errors.CoordinateError">CoordinateError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.errors.FlatProtError">FlatProtError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#logger">Logger</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.logger">logger</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.core.logger.getLogger">getLogger</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../transformation/">Transformation & Projection</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scene/">Scene</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../rendering/">Rendering</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../alignment/">DatabaseAlignment</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">FlatProt</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">API Reference</li>
      <li class="breadcrumb-item active">Core</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/t03i/FlatProt/edit/master/docs/api/core.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="core-api">Core API</h1>
<p>This section documents the core data structures and fundamental types used within FlatProt.</p>
<h2 id="structure-representation">Structure Representation</h2>


<div class="doc doc-object doc-class">



<a id="flatprot.core.Structure"></a>
    <div class="doc doc-contents first">


        <p>Represents a complete protein structure composed of multiple chains.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/core/structure.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Structure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a complete protein structure composed of multiple chains.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chains</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Chain</span><span class="p">],</span> <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes a Structure object.</span>

<span class="sd">        Args:</span>
<span class="sd">            chains: A list of Chain objects representing the chains in the structure.</span>
<span class="sd">            id: An optional identifier for the structure (e.g., PDB ID or filename stem).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span> <span class="o">=</span> <span class="p">{</span><span class="n">chain</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="n">chain</span> <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">chains</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span> <span class="ow">or</span> <span class="s2">&quot;unknown_structure&quot;</span>  <span class="c1"># Assign ID or a default</span>
        <span class="c1"># Pre-calculate total coordinates for validation if needed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_total_coordinates</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span> <span class="k">if</span> <span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Chain</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a chain by its ID.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="p">[</span><span class="n">chain_id</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ResidueCoordinate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a chain ID or ResidueCoordinate exists in the structure.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chain_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">chain_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chain_id</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">chain_id</span><span class="o">.</span><span class="n">chain_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span>
                <span class="ow">and</span> <span class="n">chain_id</span><span class="o">.</span><span class="n">residue_index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="p">[</span><span class="n">chain_id</span><span class="o">.</span><span class="n">chain_id</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Chain</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over chain IDs and Chain objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Chain</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return an iterator over chain ID / Chain pairs.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Chain</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return an iterator over Chain objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of chains in the structure.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">residues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ResidueType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a flattened list of all residues across all chains.&quot;&quot;&quot;</span>
        <span class="n">all_residues</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">all_residues</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">all_residues</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a concatenated array of all coordinates across all chains, or None if empty.&quot;&quot;&quot;</span>
        <span class="n">all_coords</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span>
            <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">all_coords</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">all_coords</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Structure(ID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">, Chains: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="nf">apply_vectorized_transformation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">transformer_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Structure&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Applies a transformation function to all coordinates and returns a new Structure.</span>

<span class="sd">        Args:</span>
<span class="sd">            transformer_func: A function that takes an (N, 3) coordinate array</span>
<span class="sd">                              and returns a transformed (N, 3) array.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new Structure instance with transformed coordinates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_chains</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">start_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">original_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span>
        <span class="k">if</span> <span class="n">original_coords</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Handle case with no coordinates - return a structure with chains having None coordinates</span>
            <span class="c1"># Recreate chains with None coords, ensuring topology is preserved</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">chain</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># Create new chain with None coords</span>
                <span class="n">new_chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Chain</span><span class="p">(</span>
                        <span class="n">chain_id</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                        <span class="n">residues</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">,</span>  <span class="c1"># Use property to get list</span>
                        <span class="n">index</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>  <span class="c1"># Use original index</span>
                        <span class="n">coordinates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Explicitly None</span>
                        <span class="c1"># Pass a copy of the original secondary structure list</span>
                        <span class="n">secondary_structure</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">_Chain__secondary_structure</span><span class="p">),</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">Structure</span><span class="p">(</span><span class="n">new_chains</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="n">transformed_coords</span> <span class="o">=</span> <span class="n">transformer_func</span><span class="p">(</span><span class="n">original_coords</span><span class="p">)</span>

        <span class="c1"># Check for shape change after transformation</span>
        <span class="k">if</span> <span class="n">transformed_coords</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">original_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Transformer function changed coordinate array shape from &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">original_coords</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">transformed_coords</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="p">(</span>
            <span class="n">_</span><span class="p">,</span>
            <span class="n">chain</span><span class="p">,</span>
        <span class="p">)</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">):</span>  <span class="c1"># Iterate in insertion order (Python 3.7+) or sorted order if needed</span>
            <span class="n">num_coords_in_chain</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span> <span class="k">if</span> <span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">num_coords_in_chain</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Slice the transformed coordinates for the current chain</span>
                <span class="n">chain_transformed_coords</span> <span class="o">=</span> <span class="n">transformed_coords</span><span class="p">[</span>
                    <span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="n">num_coords_in_chain</span>
                <span class="p">]</span>
                <span class="c1"># Create the new chain with the sliced coordinates</span>
                <span class="n">new_chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Chain</span><span class="p">(</span>
                        <span class="n">chain_id</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                        <span class="n">residues</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">,</span>
                        <span class="n">index</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                        <span class="n">coordinates</span><span class="o">=</span><span class="n">chain_transformed_coords</span><span class="p">,</span>
                        <span class="c1"># Pass a copy of the original secondary structure list</span>
                        <span class="n">secondary_structure</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">_Chain__secondary_structure</span><span class="p">),</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="n">start_index</span> <span class="o">+=</span> <span class="n">num_coords_in_chain</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Handle chains originally having no coordinates</span>
                <span class="n">new_chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Chain</span><span class="p">(</span>
                        <span class="n">chain_id</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                        <span class="n">residues</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">,</span>
                        <span class="n">index</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                        <span class="n">coordinates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Keep coordinates as None</span>
                        <span class="n">secondary_structure</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">_Chain__secondary_structure</span><span class="p">),</span>
                    <span class="p">)</span>
                <span class="p">)</span>

        <span class="c1"># Ensure all coordinates were assigned</span>
        <span class="k">if</span> <span class="n">start_index</span> <span class="o">!=</span> <span class="n">transformed_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Coordinate slicing error: processed </span><span class="si">{</span><span class="n">start_index</span><span class="si">}</span><span class="s2"> coordinates, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;but expected </span><span class="si">{</span><span class="n">transformed_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">Structure</span><span class="p">(</span><span class="n">new_chains</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_coordinate_at_residue</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">residue</span><span class="p">:</span> <span class="n">ResidueCoordinate</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the 3D coordinate for a specific residue.</span>

<span class="sd">        Args:</span>
<span class="sd">            residue: The residue coordinate to query.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A NumPy array of coordinates (shape [3]) representing the residue&#39;s</span>
<span class="sd">            position (X, Y, Z), or None if the residue is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">chain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">chain_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">chain</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Use the Chain&#39;s __contains__ and __getitem__ for residue lookup</span>
        <span class="k">if</span> <span class="n">residue</span><span class="o">.</span><span class="n">residue_index</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">:</span>
            <span class="n">target_residue_coord</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[</span><span class="n">residue</span><span class="o">.</span><span class="n">residue_index</span><span class="p">]</span>
            <span class="c1"># Access the coordinates using the coordinate_index stored in ResidueCoordinate</span>
            <span class="c1"># Ensure the chain has coordinates and the index is valid</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">target_residue_coord</span><span class="o">.</span><span class="n">coordinate_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[</span><span class="n">target_residue_coord</span><span class="o">.</span><span class="n">coordinate_index</span><span class="p">]</span>

        <span class="c1"># Residue index not found in chain or coordinate index invalid</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">with_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Structure&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new Structure with the given coordinates, preserving topology.</span>

<span class="sd">        Args:</span>
<span class="sd">            coordinates: A NumPy array of shape (N, 3) containing the new coordinates,</span>
<span class="sd">                         ordered consistently with the original structure&#39;s concatenated coordinates.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new Structure instance with the provided coordinates.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the shape or total number of input coordinates does not match</span>
<span class="sd">                        the original structure&#39;s coordinate count.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Input coordinates must be a numpy array.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">coordinates</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">coordinates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Input coordinates must have shape (N, 3), got </span><span class="si">{</span><span class="n">coordinates</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Validate that the number of provided coordinates matches the original structure</span>
        <span class="k">if</span> <span class="n">coordinates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total_coordinates</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Input coordinates count (</span><span class="si">{</span><span class="n">coordinates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">) does not match &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;the original structure&#39;s total coordinates (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_total_coordinates</span><span class="si">}</span><span class="s2">).&quot;</span>
            <span class="p">)</span>

        <span class="n">new_chains</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">start_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="p">(</span>
            <span class="n">_</span><span class="p">,</span>
            <span class="n">chain</span><span class="p">,</span>
        <span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>  <span class="c1"># Iterate through original chains to maintain order</span>
            <span class="n">num_coords_in_chain</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span> <span class="k">if</span> <span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">num_coords_in_chain</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Slice the *new* coordinates array for the current chain</span>
                <span class="n">new_chain_coords</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span>
                    <span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="n">num_coords_in_chain</span>
                <span class="p">]</span>
                <span class="c1"># Create the new chain with the sliced coordinates</span>
                <span class="n">new_chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Chain</span><span class="p">(</span>
                        <span class="n">chain_id</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                        <span class="n">residues</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">,</span>
                        <span class="n">index</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                        <span class="n">coordinates</span><span class="o">=</span><span class="n">new_chain_coords</span><span class="p">,</span>
                        <span class="c1"># Pass a copy of the original secondary structure list</span>
                        <span class="n">secondary_structure</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">_Chain__secondary_structure</span><span class="p">),</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="n">start_index</span> <span class="o">+=</span> <span class="n">num_coords_in_chain</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Handle chains originally having no coordinates</span>
                <span class="n">new_chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Chain</span><span class="p">(</span>
                        <span class="n">chain_id</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                        <span class="n">residues</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">,</span>
                        <span class="n">index</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                        <span class="n">coordinates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Keep coordinates as None</span>
                        <span class="n">secondary_structure</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">_Chain__secondary_structure</span><span class="p">),</span>
                    <span class="p">)</span>
                <span class="p">)</span>

        <span class="c1"># Final check to ensure all provided coordinates were used</span>
        <span class="k">if</span> <span class="n">start_index</span> <span class="o">!=</span> <span class="n">coordinates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># Should not happen if initial count check passes, but good sanity check</span>
                <span class="sa">f</span><span class="s2">&quot;Coordinate assignment error during &#39;with_coordinates&#39;: processed </span><span class="si">{</span><span class="n">start_index</span><span class="si">}</span><span class="s2"> coordinates, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;but input had </span><span class="si">{</span><span class="n">coordinates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">Structure</span><span class="p">(</span><span class="n">new_chains</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="flatprot.core.Structure.coordinates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">coordinates</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get a concatenated array of all coordinates across all chains, or None if empty.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="flatprot.core.Structure.residues" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">residues</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get a flattened list of all residues across all chains.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h2 id="flatprot.core.Structure.__contains__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__contains__</span><span class="p">(</span><span class="n">chain_id</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Check if a chain ID or ResidueCoordinate exists in the structure.</p>


            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ResidueCoordinate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a chain ID or ResidueCoordinate exists in the structure.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chain_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">chain_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chain_id</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">chain_id</span><span class="o">.</span><span class="n">chain_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span>
            <span class="ow">and</span> <span class="n">chain_id</span><span class="o">.</span><span class="n">residue_index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="p">[</span><span class="n">chain_id</span><span class="o">.</span><span class="n">chain_id</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="flatprot.core.Structure.__getitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">chain_id</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get a chain by its ID.</p>


            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Chain</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a chain by its ID.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="p">[</span><span class="n">chain_id</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="flatprot.core.Structure.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">chains</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Initializes a Structure object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chains</code></b>
                  (<code><span title="list">list</span>[<span title="flatprot.core.structure.Chain">Chain</span>]</code>)
              –
              <div class="doc-md-description">
                <p>A list of Chain objects representing the chains in the structure.</p>
              </div>
            </li>
            <li>
              <b><code>id</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>An optional identifier for the structure (e.g., PDB ID or filename stem).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chains</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Chain</span><span class="p">],</span> <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes a Structure object.</span>

<span class="sd">    Args:</span>
<span class="sd">        chains: A list of Chain objects representing the chains in the structure.</span>
<span class="sd">        id: An optional identifier for the structure (e.g., PDB ID or filename stem).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span> <span class="o">=</span> <span class="p">{</span><span class="n">chain</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="n">chain</span> <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">chains</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span> <span class="ow">or</span> <span class="s2">&quot;unknown_structure&quot;</span>  <span class="c1"># Assign ID or a default</span>
    <span class="c1"># Pre-calculate total coordinates for validation if needed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_total_coordinates</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span> <span class="k">if</span> <span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="flatprot.core.Structure.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Iterate over chain IDs and Chain objects.</p>


            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Chain</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over chain IDs and Chain objects.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="flatprot.core.Structure.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Return the number of chains in the structure.</p>


            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the number of chains in the structure.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="flatprot.core.Structure.apply_vectorized_transformation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_vectorized_transformation</span><span class="p">(</span><span class="n">transformer_func</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Applies a transformation function to all coordinates and returns a new Structure.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>transformer_func</code></b>
                  (<code><span title="typing.Callable">Callable</span>[[<span title="numpy.ndarray">ndarray</span>], <span title="numpy.ndarray">ndarray</span>]</code>)
              –
              <div class="doc-md-description">
                <p>A function that takes an (N, 3) coordinate array
              and returns a transformed (N, 3) array.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="flatprot.core.structure.Structure" href="#flatprot.core.Structure">Structure</a></code>
              –
              <div class="doc-md-description">
                <p>A new Structure instance with transformed coordinates.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply_vectorized_transformation</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">transformer_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Structure&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Applies a transformation function to all coordinates and returns a new Structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        transformer_func: A function that takes an (N, 3) coordinate array</span>
<span class="sd">                          and returns a transformed (N, 3) array.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new Structure instance with transformed coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_chains</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">start_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">original_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span>
    <span class="k">if</span> <span class="n">original_coords</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Handle case with no coordinates - return a structure with chains having None coordinates</span>
        <span class="c1"># Recreate chains with None coords, ensuring topology is preserved</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">chain</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Create new chain with None coords</span>
            <span class="n">new_chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Chain</span><span class="p">(</span>
                    <span class="n">chain_id</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                    <span class="n">residues</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">,</span>  <span class="c1"># Use property to get list</span>
                    <span class="n">index</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>  <span class="c1"># Use original index</span>
                    <span class="n">coordinates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Explicitly None</span>
                    <span class="c1"># Pass a copy of the original secondary structure list</span>
                    <span class="n">secondary_structure</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">_Chain__secondary_structure</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">Structure</span><span class="p">(</span><span class="n">new_chains</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="n">transformed_coords</span> <span class="o">=</span> <span class="n">transformer_func</span><span class="p">(</span><span class="n">original_coords</span><span class="p">)</span>

    <span class="c1"># Check for shape change after transformation</span>
    <span class="k">if</span> <span class="n">transformed_coords</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">original_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Transformer function changed coordinate array shape from &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">original_coords</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">transformed_coords</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="p">(</span>
        <span class="n">_</span><span class="p">,</span>
        <span class="n">chain</span><span class="p">,</span>
    <span class="p">)</span> <span class="ow">in</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">):</span>  <span class="c1"># Iterate in insertion order (Python 3.7+) or sorted order if needed</span>
        <span class="n">num_coords_in_chain</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span> <span class="k">if</span> <span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">num_coords_in_chain</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Slice the transformed coordinates for the current chain</span>
            <span class="n">chain_transformed_coords</span> <span class="o">=</span> <span class="n">transformed_coords</span><span class="p">[</span>
                <span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="n">num_coords_in_chain</span>
            <span class="p">]</span>
            <span class="c1"># Create the new chain with the sliced coordinates</span>
            <span class="n">new_chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Chain</span><span class="p">(</span>
                    <span class="n">chain_id</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                    <span class="n">residues</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">,</span>
                    <span class="n">index</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                    <span class="n">coordinates</span><span class="o">=</span><span class="n">chain_transformed_coords</span><span class="p">,</span>
                    <span class="c1"># Pass a copy of the original secondary structure list</span>
                    <span class="n">secondary_structure</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">_Chain__secondary_structure</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">start_index</span> <span class="o">+=</span> <span class="n">num_coords_in_chain</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Handle chains originally having no coordinates</span>
            <span class="n">new_chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Chain</span><span class="p">(</span>
                    <span class="n">chain_id</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                    <span class="n">residues</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">,</span>
                    <span class="n">index</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                    <span class="n">coordinates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Keep coordinates as None</span>
                    <span class="n">secondary_structure</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">_Chain__secondary_structure</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># Ensure all coordinates were assigned</span>
    <span class="k">if</span> <span class="n">start_index</span> <span class="o">!=</span> <span class="n">transformed_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Coordinate slicing error: processed </span><span class="si">{</span><span class="n">start_index</span><span class="si">}</span><span class="s2"> coordinates, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;but expected </span><span class="si">{</span><span class="n">transformed_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">Structure</span><span class="p">(</span><span class="n">new_chains</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="flatprot.core.Structure.get_coordinate_at_residue" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_coordinate_at_residue</span><span class="p">(</span><span class="n">residue</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the 3D coordinate for a specific residue.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>residue</code></b>
                  (<code><a class="autorefs autorefs-internal" title="ResidueCoordinate


  
      dataclass
   (flatprot.core.coordinates.ResidueCoordinate)" href="#flatprot.core.coordinates.ResidueCoordinate">ResidueCoordinate</a></code>)
              –
              <div class="doc-md-description">
                <p>The residue coordinate to query.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Optional">Optional</span>[<span title="numpy.ndarray">ndarray</span>]</code>
              –
              <div class="doc-md-description">
                <p>A NumPy array of coordinates (shape [3]) representing the residue's</p>
              </div>
            </li>
            <li>
                  <code><span title="typing.Optional">Optional</span>[<span title="numpy.ndarray">ndarray</span>]</code>
              –
              <div class="doc-md-description">
                <p>position (X, Y, Z), or None if the residue is not found.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_coordinate_at_residue</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">residue</span><span class="p">:</span> <span class="n">ResidueCoordinate</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the 3D coordinate for a specific residue.</span>

<span class="sd">    Args:</span>
<span class="sd">        residue: The residue coordinate to query.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A NumPy array of coordinates (shape [3]) representing the residue&#39;s</span>
<span class="sd">        position (X, Y, Z), or None if the residue is not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">chain_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">chain</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># Use the Chain&#39;s __contains__ and __getitem__ for residue lookup</span>
    <span class="k">if</span> <span class="n">residue</span><span class="o">.</span><span class="n">residue_index</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">:</span>
        <span class="n">target_residue_coord</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[</span><span class="n">residue</span><span class="o">.</span><span class="n">residue_index</span><span class="p">]</span>
        <span class="c1"># Access the coordinates using the coordinate_index stored in ResidueCoordinate</span>
        <span class="c1"># Ensure the chain has coordinates and the index is valid</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">target_residue_coord</span><span class="o">.</span><span class="n">coordinate_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[</span><span class="n">target_residue_coord</span><span class="o">.</span><span class="n">coordinate_index</span><span class="p">]</span>

    <span class="c1"># Residue index not found in chain or coordinate index invalid</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="flatprot.core.Structure.items" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">items</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Return an iterator over chain ID / Chain pairs.</p>


            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Chain</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an iterator over chain ID / Chain pairs.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="flatprot.core.Structure.values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">values</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Return an iterator over Chain objects.</p>


            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Chain</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an iterator over Chain objects.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chains</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="flatprot.core.Structure.with_coordinates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">with_coordinates</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a new Structure with the given coordinates, preserving topology.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>coordinates</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>A NumPy array of shape (N, 3) containing the new coordinates,
         ordered consistently with the original structure's concatenated coordinates.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="flatprot.core.structure.Structure" href="#flatprot.core.Structure">Structure</a></code>
              –
              <div class="doc-md-description">
                <p>A new Structure instance with the provided coordinates.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="ValueError">ValueError</span></code>
              –
              <div class="doc-md-description">
                <p>If the shape or total number of input coordinates does not match
        the original structure's coordinate count.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">with_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Structure&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new Structure with the given coordinates, preserving topology.</span>

<span class="sd">    Args:</span>
<span class="sd">        coordinates: A NumPy array of shape (N, 3) containing the new coordinates,</span>
<span class="sd">                     ordered consistently with the original structure&#39;s concatenated coordinates.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new Structure instance with the provided coordinates.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the shape or total number of input coordinates does not match</span>
<span class="sd">                    the original structure&#39;s coordinate count.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Input coordinates must be a numpy array.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">coordinates</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">coordinates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Input coordinates must have shape (N, 3), got </span><span class="si">{</span><span class="n">coordinates</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Validate that the number of provided coordinates matches the original structure</span>
    <span class="k">if</span> <span class="n">coordinates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total_coordinates</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Input coordinates count (</span><span class="si">{</span><span class="n">coordinates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">) does not match &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;the original structure&#39;s total coordinates (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_total_coordinates</span><span class="si">}</span><span class="s2">).&quot;</span>
        <span class="p">)</span>

    <span class="n">new_chains</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">start_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="p">(</span>
        <span class="n">_</span><span class="p">,</span>
        <span class="n">chain</span><span class="p">,</span>
    <span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>  <span class="c1"># Iterate through original chains to maintain order</span>
        <span class="n">num_coords_in_chain</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span> <span class="k">if</span> <span class="n">chain</span><span class="o">.</span><span class="n">coordinates</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">num_coords_in_chain</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Slice the *new* coordinates array for the current chain</span>
            <span class="n">new_chain_coords</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span>
                <span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="n">num_coords_in_chain</span>
            <span class="p">]</span>
            <span class="c1"># Create the new chain with the sliced coordinates</span>
            <span class="n">new_chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Chain</span><span class="p">(</span>
                    <span class="n">chain_id</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                    <span class="n">residues</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">,</span>
                    <span class="n">index</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                    <span class="n">coordinates</span><span class="o">=</span><span class="n">new_chain_coords</span><span class="p">,</span>
                    <span class="c1"># Pass a copy of the original secondary structure list</span>
                    <span class="n">secondary_structure</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">_Chain__secondary_structure</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">start_index</span> <span class="o">+=</span> <span class="n">num_coords_in_chain</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Handle chains originally having no coordinates</span>
            <span class="n">new_chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Chain</span><span class="p">(</span>
                    <span class="n">chain_id</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                    <span class="n">residues</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">,</span>
                    <span class="n">index</span><span class="o">=</span><span class="n">chain</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                    <span class="n">coordinates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Keep coordinates as None</span>
                    <span class="n">secondary_structure</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">_Chain__secondary_structure</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># Final check to ensure all provided coordinates were used</span>
    <span class="k">if</span> <span class="n">start_index</span> <span class="o">!=</span> <span class="n">coordinates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># Should not happen if initial count check passes, but good sanity check</span>
            <span class="sa">f</span><span class="s2">&quot;Coordinate assignment error during &#39;with_coordinates&#39;: processed </span><span class="si">{</span><span class="n">start_index</span><span class="si">}</span><span class="s2"> coordinates, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;but input had </span><span class="si">{</span><span class="n">coordinates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">Structure</span><span class="p">(</span><span class="n">new_chains</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>options:
show_root_heading: true
members_order: source</p>
<h2 id="coordinate-and-range-types">Coordinate and Range Types</h2>


<div class="doc doc-object doc-module">



<a id="flatprot.core.coordinates"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="flatprot.core.coordinates.ResidueCoordinate" class="doc doc-heading">
            <code>ResidueCoordinate</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">








              <details class="quote">
                <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">ResidueCoordinate</span><span class="p">:</span>
    <span class="n">chain_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">residue_index</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">residue_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ResidueType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">coordinate_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ResidueCoordinate&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse &#39;CHAIN:INDEX&#39; format (e.g., &#39;A:123&#39;).</span>

<span class="sd">        Args:</span>
<span class="sd">            string: The string representation to parse.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A ResidueCoordinate instance.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the string format is invalid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">_RESIDUE_COORD_PATTERN</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid ResidueCoordinate format: &#39;</span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">&#39;. Expected &#39;CHAIN:INDEX&#39;.&quot;</span>
            <span class="p">)</span>
        <span class="n">chain_name</span><span class="p">,</span> <span class="n">residue_index_str</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ResidueCoordinate</span><span class="p">(</span><span class="n">chain_name</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">residue_index_str</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">residue_type</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_index</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_index</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot compare ResidueCoordinate with </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">chain_id</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">residue_index</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">residue_index</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot compare ResidueCoordinate with </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">chain_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">chain_id</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">residue_index</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">residue_index</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="flatprot.core.coordinates.ResidueCoordinate.from_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Parse 'CHAIN:INDEX' format (e.g., 'A:123').</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>string</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The string representation to parse.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="ResidueCoordinate


  
      dataclass
   (flatprot.core.coordinates.ResidueCoordinate)" href="#flatprot.core.coordinates.ResidueCoordinate">ResidueCoordinate</a></code>
              –
              <div class="doc-md-description">
                <p>A ResidueCoordinate instance.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="ValueError">ValueError</span></code>
              –
              <div class="doc-md-description">
                <p>If the string format is invalid.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ResidueCoordinate&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse &#39;CHAIN:INDEX&#39; format (e.g., &#39;A:123&#39;).</span>

<span class="sd">    Args:</span>
<span class="sd">        string: The string representation to parse.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A ResidueCoordinate instance.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the string format is invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">_RESIDUE_COORD_PATTERN</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid ResidueCoordinate format: &#39;</span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">&#39;. Expected &#39;CHAIN:INDEX&#39;.&quot;</span>
        <span class="p">)</span>
    <span class="n">chain_name</span><span class="p">,</span> <span class="n">residue_index_str</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ResidueCoordinate</span><span class="p">(</span><span class="n">chain_name</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">residue_index_str</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.core.coordinates.ResidueRange" class="doc doc-heading">
            <code>ResidueRange</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Represents a continuous range of residues within a single chain.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">ResidueRange</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a continuous range of residues within a single chain.&quot;&quot;&quot;</span>

    <span class="n">chain_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">start</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">end</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">coordinates_start_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">secondary_structure_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SecondaryStructureType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">to_set</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ResidueRangeSet&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ResidueRangeSet</span><span class="p">([</span><span class="bp">self</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid range: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2"> &gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ResidueCoordinate</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over all ResidueCoordinates in this range.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">ResidueCoordinate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of residues in this range.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ResidueRange&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse &#39;CHAIN:START-END&#39; format (e.g., &#39;A:14-20&#39;).</span>

<span class="sd">        Args:</span>
<span class="sd">            string: The string representation to parse.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A ResidueRange instance.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the string format is invalid or start &gt; end.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">_RESIDUE_RANGE_PATTERN</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid ResidueRange format: &#39;</span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">&#39;. Expected &#39;CHAIN:START-END&#39;.&quot;</span>
            <span class="p">)</span>
        <span class="n">chain</span><span class="p">,</span> <span class="n">start_str</span><span class="p">,</span> <span class="n">end_str</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_str</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">end_str</span><span class="p">)</span>
        <span class="c1"># The __post_init__ check for start &gt; end will still run</span>
        <span class="k">return</span> <span class="n">ResidueRange</span><span class="p">(</span><span class="n">chain</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondary_structure_type</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">secondary_structure_type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;ResidueRange&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compare ranges for sorting.</span>

<span class="sd">        Sorts first by chain_id, then by start position.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: Another ResidueRange to compare with</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if this range should come before the other</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueRange</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot compare ResidueRange with </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">chain_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">chain_id</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">start</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two ranges are equal.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: Another object to compare with</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if the ranges are equal</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueRange</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot compare ResidueRange with </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">chain_id</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">start</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">end</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this range contains another range or residue coordinate.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: Another object to check containment with</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if this range contains the other object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueRange</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">chain_id</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">start</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">end</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">chain_id</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">residue_index</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_adjacent_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;ResidueRange&quot;</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this range is adjacent to another range or residue coordinate.</span>

<span class="sd">        Two ranges are considered adjacent if they are in the same chain and</span>
<span class="sd">        one range&#39;s end is exactly one residue before the other range&#39;s start.</span>
<span class="sd">        For example, A:10-15 is adjacent to A:16-20, but not to A:15-20 (overlap)</span>
<span class="sd">        or A:17-20 (gap).</span>

<span class="sd">        A range and a residue coordinate are considered adjacent if they are in the</span>
<span class="sd">        same chain and the coordinate is exactly one residue before the range&#39;s start</span>
<span class="sd">        or exactly one residue after the range&#39;s end.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: The other range or residue coordinate to check adjacency with.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if the range is adjacent to the other object, False otherwise.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If other is not a ResidueRange or ResidueCoordinate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">ResidueRange</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot check adjacency with </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Must be in the same chain to be adjacent</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">chain_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueRange</span><span class="p">):</span>
            <span class="c1"># Check if self&#39;s end is exactly one residue before other&#39;s start</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">start</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="c1"># Check if other&#39;s end is exactly one residue before self&#39;s start</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># ResidueCoordinate</span>
            <span class="c1"># Check if the coordinate is exactly one residue before the range&#39;s start</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">residue_index</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="c1"># Check if the coordinate is exactly one residue after the range&#39;s end</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">residue_index</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="flatprot.core.coordinates.ResidueRange.__contains__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__contains__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this range contains another range or residue coordinate.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>other</code></b>
                  (<code><span title="object">object</span></code>)
              –
              <div class="doc-md-description">
                <p>Another object to check containment with</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>bool</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if this range contains the other object</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if this range contains another range or residue coordinate.</span>

<span class="sd">    Args:</span>
<span class="sd">        other: Another object to check containment with</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if this range contains the other object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueRange</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">chain_id</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">start</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">end</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">chain_id</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">residue_index</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="flatprot.core.coordinates.ResidueRange.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if two ranges are equal.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>other</code></b>
                  (<code><span title="object">object</span></code>)
              –
              <div class="doc-md-description">
                <p>Another object to compare with</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>bool</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the ranges are equal</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if two ranges are equal.</span>

<span class="sd">    Args:</span>
<span class="sd">        other: Another object to compare with</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the ranges are equal</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueRange</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot compare ResidueRange with </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">chain_id</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">start</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">end</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="flatprot.core.coordinates.ResidueRange.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Iterate over all ResidueCoordinates in this range.</p>


            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ResidueCoordinate</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over all ResidueCoordinates in this range.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">ResidueCoordinate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="flatprot.core.coordinates.ResidueRange.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Number of residues in this range.</p>


            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Number of residues in this range.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="flatprot.core.coordinates.ResidueRange.__lt__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__lt__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compare ranges for sorting.</p>
<p>Sorts first by chain_id, then by start position.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>other</code></b>
                  (<code><a class="autorefs autorefs-internal" title="ResidueRange


  
      dataclass
   (flatprot.core.coordinates.ResidueRange)" href="#flatprot.core.coordinates.ResidueRange">ResidueRange</a></code>)
              –
              <div class="doc-md-description">
                <p>Another ResidueRange to compare with</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>bool</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if this range should come before the other</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;ResidueRange&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare ranges for sorting.</span>

<span class="sd">    Sorts first by chain_id, then by start position.</span>

<span class="sd">    Args:</span>
<span class="sd">        other: Another ResidueRange to compare with</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if this range should come before the other</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueRange</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot compare ResidueRange with </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">chain_id</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">chain_id</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">start</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="flatprot.core.coordinates.ResidueRange.from_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Parse 'CHAIN:START-END' format (e.g., 'A:14-20').</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>string</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The string representation to parse.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="ResidueRange


  
      dataclass
   (flatprot.core.coordinates.ResidueRange)" href="#flatprot.core.coordinates.ResidueRange">ResidueRange</a></code>
              –
              <div class="doc-md-description">
                <p>A ResidueRange instance.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="ValueError">ValueError</span></code>
              –
              <div class="doc-md-description">
                <p>If the string format is invalid or start &gt; end.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ResidueRange&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse &#39;CHAIN:START-END&#39; format (e.g., &#39;A:14-20&#39;).</span>

<span class="sd">    Args:</span>
<span class="sd">        string: The string representation to parse.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A ResidueRange instance.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the string format is invalid or start &gt; end.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">_RESIDUE_RANGE_PATTERN</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid ResidueRange format: &#39;</span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">&#39;. Expected &#39;CHAIN:START-END&#39;.&quot;</span>
        <span class="p">)</span>
    <span class="n">chain</span><span class="p">,</span> <span class="n">start_str</span><span class="p">,</span> <span class="n">end_str</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
    <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_str</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">end_str</span><span class="p">)</span>
    <span class="c1"># The __post_init__ check for start &gt; end will still run</span>
    <span class="k">return</span> <span class="n">ResidueRange</span><span class="p">(</span><span class="n">chain</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="flatprot.core.coordinates.ResidueRange.is_adjacent_to" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_adjacent_to</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this range is adjacent to another range or residue coordinate.</p>
<p>Two ranges are considered adjacent if they are in the same chain and
one range's end is exactly one residue before the other range's start.
For example, A:10-15 is adjacent to A:16-20, but not to A:15-20 (overlap)
or A:17-20 (gap).</p>
<p>A range and a residue coordinate are considered adjacent if they are in the
same chain and the coordinate is exactly one residue before the range's start
or exactly one residue after the range's end.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>other</code></b>
                  (<code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="ResidueRange


  
      dataclass
   (flatprot.core.coordinates.ResidueRange)" href="#flatprot.core.coordinates.ResidueRange">ResidueRange</a>, <a class="autorefs autorefs-internal" title="ResidueCoordinate


  
      dataclass
   (flatprot.core.coordinates.ResidueCoordinate)" href="#flatprot.core.coordinates.ResidueCoordinate">ResidueCoordinate</a>]</code>)
              –
              <div class="doc-md-description">
                <p>The other range or residue coordinate to check adjacency with.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>bool</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the range is adjacent to the other object, False otherwise.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="TypeError">TypeError</span></code>
              –
              <div class="doc-md-description">
                <p>If other is not a ResidueRange or ResidueCoordinate.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_adjacent_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;ResidueRange&quot;</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if this range is adjacent to another range or residue coordinate.</span>

<span class="sd">    Two ranges are considered adjacent if they are in the same chain and</span>
<span class="sd">    one range&#39;s end is exactly one residue before the other range&#39;s start.</span>
<span class="sd">    For example, A:10-15 is adjacent to A:16-20, but not to A:15-20 (overlap)</span>
<span class="sd">    or A:17-20 (gap).</span>

<span class="sd">    A range and a residue coordinate are considered adjacent if they are in the</span>
<span class="sd">    same chain and the coordinate is exactly one residue before the range&#39;s start</span>
<span class="sd">    or exactly one residue after the range&#39;s end.</span>

<span class="sd">    Args:</span>
<span class="sd">        other: The other range or residue coordinate to check adjacency with.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the range is adjacent to the other object, False otherwise.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If other is not a ResidueRange or ResidueCoordinate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">ResidueRange</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot check adjacency with </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Must be in the same chain to be adjacent</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">chain_id</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueRange</span><span class="p">):</span>
        <span class="c1"># Check if self&#39;s end is exactly one residue before other&#39;s start</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">start</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># Check if other&#39;s end is exactly one residue before self&#39;s start</span>
        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># ResidueCoordinate</span>
        <span class="c1"># Check if the coordinate is exactly one residue before the range&#39;s start</span>
        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">residue_index</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># Check if the coordinate is exactly one residue after the range&#39;s end</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">residue_index</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.core.coordinates.ResidueRangeSet" class="doc doc-heading">
            <code>ResidueRangeSet</code>


</h2>


    <div class="doc doc-contents ">


        <p>Represents multiple ranges of residues, potentially across different chains.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ResidueRangeSet</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents multiple ranges of residues, potentially across different chains.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ranges</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ResidueRange</span><span class="p">]):</span>
        <span class="c1"># Sort ranges for consistent representation and efficient searching</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ranges</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">chain_id</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">start</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ResidueRangeSet&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse &#39;A:14-20, B:10-15&#39; format.</span>

<span class="sd">        Ranges are separated by commas. Whitespace around ranges and commas</span>
<span class="sd">        is ignored.</span>

<span class="sd">        Args:</span>
<span class="sd">            string: The string representation to parse.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A ResidueRangeSet instance.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the string is empty, contains empty parts after</span>
<span class="sd">                      splitting by comma, or if any individual range</span>
<span class="sd">                      part is invalid according to ResidueRange.from_string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">string</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input string for ResidueRangeSet cannot be empty.&quot;</span><span class="p">)</span>

        <span class="n">parts</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
        <span class="n">ranges</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
            <span class="n">stripped_part</span> <span class="o">=</span> <span class="n">part</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">stripped_part</span><span class="p">:</span>
                <span class="c1"># Handle cases like &quot;A:1-5,,B:6-10&quot; or leading/trailing commas</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Empty range part found in string: &#39;</span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">&#39; after splitting by comma.&quot;</span>
                <span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Leverage ResidueRange&#39;s parsing and validation</span>
                <span class="n">ranges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResidueRange</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">stripped_part</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># Re-raise with context about which part failed</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Error parsing range part &#39;</span><span class="si">{</span><span class="n">stripped_part</span><span class="si">}</span><span class="s2">&#39; in &#39;</span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">ranges</span><span class="p">:</span>
            <span class="c1"># This case might be redundant if empty string/parts are caught above,</span>
            <span class="c1"># but kept for robustness, e.g., if string only contains commas/whitespace.</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No valid residue ranges found in string: &#39;</span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ResidueRangeSet</span><span class="p">(</span><span class="n">ranges</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ResidueCoordinate</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over all ResidueCoordinates in all ranges.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">range_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">:</span>
            <span class="k">yield from</span> <span class="n">range_</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Total number of residues across all ranges.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">range_</span><span class="p">)</span> <span class="k">for</span> <span class="n">range_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ResidueRangeSet(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this range set contains another range or residue coordinate.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: Another object to check containment with</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if this range set contains the other object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueRange</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">other</span> <span class="ow">in</span> <span class="n">range_</span> <span class="k">for</span> <span class="n">range_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">other</span> <span class="ow">in</span> <span class="n">range_</span> <span class="k">for</span> <span class="n">range_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two range sets are equal.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: Another object to compare with</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if the range sets are equal</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueRangeSet</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot compare ResidueRangeSet with </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">)</span> <span class="o">==</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">ranges</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_adjacent_to</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;ResidueRangeSet&quot;</span><span class="p">,</span> <span class="n">ResidueRange</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this range set is adjacent to another range set, range, or coordinate.</span>

<span class="sd">        Two range sets are considered adjacent if any range in one set is</span>
<span class="sd">        adjacent to any range in the other set. Ranges are adjacent if they</span>
<span class="sd">        are in the same chain and one range&#39;s end is exactly one residue</span>
<span class="sd">        before the other range&#39;s start, or vice versa.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: The other object to check adjacency with. Can be a ResidueRangeSet,</span>
<span class="sd">                  ResidueRange, or ResidueCoordinate.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if the range sets are adjacent, False otherwise.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If other is not a ResidueRangeSet, ResidueRange, or ResidueCoordinate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueRangeSet</span><span class="p">):</span>
            <span class="c1"># Check each pair of ranges from both sets</span>
            <span class="k">for</span> <span class="n">range1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">range2</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">ranges</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">range1</span><span class="o">.</span><span class="n">is_adjacent_to</span><span class="p">(</span><span class="n">range2</span><span class="p">):</span>
                        <span class="k">return</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">ResidueRange</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">)):</span>
            <span class="c1"># Convert the single range to a set and check adjacency</span>
            <span class="k">for</span> <span class="n">range1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">range1</span><span class="o">.</span><span class="n">is_adjacent_to</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot check adjacency with </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="flatprot.core.coordinates.ResidueRangeSet.__contains__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__contains__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this range set contains another range or residue coordinate.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>other</code></b>
                  (<code><span title="object">object</span></code>)
              –
              <div class="doc-md-description">
                <p>Another object to check containment with</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>bool</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if this range set contains the other object</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if this range set contains another range or residue coordinate.</span>

<span class="sd">    Args:</span>
<span class="sd">        other: Another object to check containment with</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if this range set contains the other object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueRange</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">other</span> <span class="ow">in</span> <span class="n">range_</span> <span class="k">for</span> <span class="n">range_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">other</span> <span class="ow">in</span> <span class="n">range_</span> <span class="k">for</span> <span class="n">range_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="flatprot.core.coordinates.ResidueRangeSet.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if two range sets are equal.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>other</code></b>
                  (<code><span title="object">object</span></code>)
              –
              <div class="doc-md-description">
                <p>Another object to compare with</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>bool</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the range sets are equal</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if two range sets are equal.</span>

<span class="sd">    Args:</span>
<span class="sd">        other: Another object to compare with</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the range sets are equal</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueRangeSet</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot compare ResidueRangeSet with </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">)</span> <span class="o">==</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">ranges</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="flatprot.core.coordinates.ResidueRangeSet.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Iterate over all ResidueCoordinates in all ranges.</p>


            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ResidueCoordinate</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over all ResidueCoordinates in all ranges.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">range_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">:</span>
        <span class="k">yield from</span> <span class="n">range_</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="flatprot.core.coordinates.ResidueRangeSet.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Total number of residues across all ranges.</p>


            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Total number of residues across all ranges.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">range_</span><span class="p">)</span> <span class="k">for</span> <span class="n">range_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="flatprot.core.coordinates.ResidueRangeSet.from_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Parse 'A:14-20, B:10-15' format.</p>
<p>Ranges are separated by commas. Whitespace around ranges and commas
is ignored.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>string</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The string representation to parse.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="ResidueRangeSet (flatprot.core.coordinates.ResidueRangeSet)" href="#flatprot.core.coordinates.ResidueRangeSet">ResidueRangeSet</a></code>
              –
              <div class="doc-md-description">
                <p>A ResidueRangeSet instance.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="ValueError">ValueError</span></code>
              –
              <div class="doc-md-description">
                <p>If the string is empty, contains empty parts after
      splitting by comma, or if any individual range
      part is invalid according to ResidueRange.from_string.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ResidueRangeSet&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse &#39;A:14-20, B:10-15&#39; format.</span>

<span class="sd">    Ranges are separated by commas. Whitespace around ranges and commas</span>
<span class="sd">    is ignored.</span>

<span class="sd">    Args:</span>
<span class="sd">        string: The string representation to parse.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A ResidueRangeSet instance.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the string is empty, contains empty parts after</span>
<span class="sd">                  splitting by comma, or if any individual range</span>
<span class="sd">                  part is invalid according to ResidueRange.from_string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">string</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input string for ResidueRangeSet cannot be empty.&quot;</span><span class="p">)</span>

    <span class="n">parts</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="n">ranges</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
        <span class="n">stripped_part</span> <span class="o">=</span> <span class="n">part</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">stripped_part</span><span class="p">:</span>
            <span class="c1"># Handle cases like &quot;A:1-5,,B:6-10&quot; or leading/trailing commas</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Empty range part found in string: &#39;</span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">&#39; after splitting by comma.&quot;</span>
            <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Leverage ResidueRange&#39;s parsing and validation</span>
            <span class="n">ranges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResidueRange</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">stripped_part</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Re-raise with context about which part failed</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Error parsing range part &#39;</span><span class="si">{</span><span class="n">stripped_part</span><span class="si">}</span><span class="s2">&#39; in &#39;</span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ranges</span><span class="p">:</span>
        <span class="c1"># This case might be redundant if empty string/parts are caught above,</span>
        <span class="c1"># but kept for robustness, e.g., if string only contains commas/whitespace.</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No valid residue ranges found in string: &#39;</span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ResidueRangeSet</span><span class="p">(</span><span class="n">ranges</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="flatprot.core.coordinates.ResidueRangeSet.is_adjacent_to" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_adjacent_to</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if this range set is adjacent to another range set, range, or coordinate.</p>
<p>Two range sets are considered adjacent if any range in one set is
adjacent to any range in the other set. Ranges are adjacent if they
are in the same chain and one range's end is exactly one residue
before the other range's start, or vice versa.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>other</code></b>
                  (<code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="ResidueRangeSet (flatprot.core.coordinates.ResidueRangeSet)" href="#flatprot.core.coordinates.ResidueRangeSet">ResidueRangeSet</a>, <a class="autorefs autorefs-internal" title="ResidueRange


  
      dataclass
   (flatprot.core.coordinates.ResidueRange)" href="#flatprot.core.coordinates.ResidueRange">ResidueRange</a>, <a class="autorefs autorefs-internal" title="ResidueCoordinate


  
      dataclass
   (flatprot.core.coordinates.ResidueCoordinate)" href="#flatprot.core.coordinates.ResidueCoordinate">ResidueCoordinate</a>]</code>)
              –
              <div class="doc-md-description">
                <p>The other object to check adjacency with. Can be a ResidueRangeSet,
  ResidueRange, or ResidueCoordinate.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>bool</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the range sets are adjacent, False otherwise.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="TypeError">TypeError</span></code>
              –
              <div class="doc-md-description">
                <p>If other is not a ResidueRangeSet, ResidueRange, or ResidueCoordinate.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/coordinates.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_adjacent_to</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;ResidueRangeSet&quot;</span><span class="p">,</span> <span class="n">ResidueRange</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if this range set is adjacent to another range set, range, or coordinate.</span>

<span class="sd">    Two range sets are considered adjacent if any range in one set is</span>
<span class="sd">    adjacent to any range in the other set. Ranges are adjacent if they</span>
<span class="sd">    are in the same chain and one range&#39;s end is exactly one residue</span>
<span class="sd">    before the other range&#39;s start, or vice versa.</span>

<span class="sd">    Args:</span>
<span class="sd">        other: The other object to check adjacency with. Can be a ResidueRangeSet,</span>
<span class="sd">              ResidueRange, or ResidueCoordinate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the range sets are adjacent, False otherwise.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If other is not a ResidueRangeSet, ResidueRange, or ResidueCoordinate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ResidueRangeSet</span><span class="p">):</span>
        <span class="c1"># Check each pair of ranges from both sets</span>
        <span class="k">for</span> <span class="n">range1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">range2</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">ranges</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">range1</span><span class="o">.</span><span class="n">is_adjacent_to</span><span class="p">(</span><span class="n">range2</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">ResidueRange</span><span class="p">,</span> <span class="n">ResidueCoordinate</span><span class="p">)):</span>
        <span class="c1"># Convert the single range to a set and check adjacency</span>
        <span class="k">for</span> <span class="n">range1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">range1</span><span class="o">.</span><span class="n">is_adjacent_to</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot check adjacency with </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><p>options:
show_root_heading: true
members_order: source</p>
<h2 id="core-errors">Core Errors</h2>


<div class="doc doc-object doc-module">



<a id="flatprot.core.errors"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="flatprot.core.errors.CoordinateCalculationError" class="doc doc-heading">
            <code>CoordinateCalculationError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CoordinateError (flatprot.core.errors.CoordinateError)" href="#flatprot.core.errors.CoordinateError">CoordinateError</a></code></p>


        <p>Error raised when calculation of display coordinates fails (e.g., insufficient points).</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/core/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CoordinateCalculationError</span><span class="p">(</span><span class="n">CoordinateError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Error raised when calculation of display coordinates fails (e.g., insufficient points).&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.core.errors.CoordinateError" class="doc doc-heading">
            <code>CoordinateError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FlatProtError (flatprot.core.errors.FlatProtError)" href="#flatprot.core.errors.FlatProtError">FlatProtError</a></code></p>


        <p>Error related to coordinate management.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/core/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CoordinateError</span><span class="p">(</span><span class="n">FlatProtError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Error related to coordinate management.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.core.errors.FlatProtError" class="doc doc-heading">
            <code>FlatProtError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Base exception class for FlatProt CLI errors.</p>
<p>This class is used as the base for all custom exceptions raised by the CLI.
It provides a consistent interface for error handling and formatting.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/core/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FlatProtError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base exception class for FlatProt CLI errors.</span>

<span class="sd">    This class is used as the base for all custom exceptions raised by the CLI.</span>
<span class="sd">    It provides a consistent interface for error handling and formatting.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div><p>options:
show_root_heading: true
members_order: source</p>
<h2 id="logger">Logger</h2>


<div class="doc doc-object doc-module">



<a id="flatprot.core.logger"></a>
    <div class="doc doc-contents first">

        <p>Logging utilities for FlatProt.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="flatprot.core.logger.getLogger" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getLogger</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">__app_name__</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get a configured logger with the given name.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>name</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code><span title="flatprot.__app_name__">__app_name__</span></code>
)
              –
              <div class="doc-md-description">
                <p>Logger name (defaults to "flatprot")</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="logging.Logger">Logger</span></code>
              –
              <div class="doc-md-description">
                <p>Configured logging.Logger instance</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/core/logger.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">getLogger</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">__app_name__</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a configured logger with the given name.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: Logger name (defaults to &quot;flatprot&quot;)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Configured logging.Logger instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the logger</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">logger</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>options:
show_root_heading: true
members_order: source</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../io/" class="btn btn-neutral float-left" title="IO"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../transformation/" class="btn btn-neutral float-right" title="Transformation & Projection">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/t03i/FlatProt" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../io/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../transformation/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
