<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://t03i.github.io/FlatProt/api/io/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>IO - FlatProt</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "IO";
        var mkdocs_page_input_path = "api/io.md";
        var mkdocs_page_url = "/FlatProt/api/io/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/json.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/toml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/numpy.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> FlatProt
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../installation/">Installation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../examples/">Examples</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Commands</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../commands/project/">Project</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../commands/align/">Align</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../commands/overlay/">Overlay</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">File Formats</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../file_formats/matrix/">Matrix Files</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../file_formats/style/">Style Files</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../file_formats/annotations/">Annotation Files</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">IO</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#io-concept">IO Concept</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#structure-parser">Structure Parser</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.GemmiStructureParser">GemmiStructureParser</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.GemmiStructureParser.parse_structure">parse_structure</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.GemmiStructureParser.save_structure">save_structure</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#style-parser">Style Parser</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.styles.StyleParser">StyleParser</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.styles.StyleParser.__init__">__init__</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.styles.StyleParser.get_element_styles">get_element_styles</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.styles.StyleParser.get_raw_data">get_raw_data</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.styles.StyleParser.parse">parse</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#annotation-parser">Annotation Parser</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.annotations.AnnotationParser">AnnotationParser</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.annotations.AnnotationParser.__init__">__init__</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.annotations.AnnotationParser.parse">parse</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#file-validation">File Validation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.validate_structure_file">validate_structure_file</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.validate_optional_files">validate_optional_files</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#io-errors">IO Errors</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors">errors</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.AnnotationError">AnnotationError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.AnnotationFileError">AnnotationFileError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.AnnotationFileNotFoundError">AnnotationFileNotFoundError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.FileError">FileError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.FileNotFoundError">FileNotFoundError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.IOError">IOError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.InvalidColorError">InvalidColorError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.InvalidFieldTypeError">InvalidFieldTypeError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.InvalidFileFormatError">InvalidFileFormatError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.InvalidMatrixDimensionsError">InvalidMatrixDimensionsError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.InvalidMatrixError">InvalidMatrixError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.InvalidMatrixFormatError">InvalidMatrixFormatError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.InvalidReferenceError">InvalidReferenceError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.InvalidStructureError">InvalidStructureError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.InvalidTomlError">InvalidTomlError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.MalformedAnnotationError">MalformedAnnotationError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.MatrixError">MatrixError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.MatrixFileError">MatrixFileError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.MatrixFileNotFoundError">MatrixFileNotFoundError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.MissingRequiredFieldError">MissingRequiredFieldError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.OutputError">OutputError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.OutputFileError">OutputFileError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.StructureError">StructureError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.StructureFileNotFoundError">StructureFileNotFoundError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.StyleError">StyleError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.StyleFileError">StyleFileError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.StyleFileNotFoundError">StyleFileNotFoundError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.StyleParsingError">StyleParsingError</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flatprot.io.errors.StyleValidationError">StyleValidationError</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core/">Core</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../transformation/">Transformation & Projection</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scene/">Scene</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../rendering/">Rendering</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../alignment/">DatabaseAlignment</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">FlatProt</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">API Reference</li>
      <li class="breadcrumb-item active">IO</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/t03i/FlatProt/edit/master/docs/api/io.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="inputoutput-api">Input/Output API</h1>
<p>This section documents the components responsible for handling file input and output in FlatProt, including parsing structure files and configuration files (styles, annotations).</p>
<h2 id="io-concept">IO Concept</h2>
<p>The IO module acts as the interface between FlatProt's internal data structures and external files. Its primary responsibilities are:</p>
<ol>
<li><strong>Structure Parsing:</strong> Reading 3D coordinates, sequence information, and potentially secondary structure assignments from standard formats like PDB and mmCIF. This often involves leveraging libraries like Gemmi (e.g., via <code>GemmiStructureParser</code>).</li>
<li><strong>Configuration Parsing:</strong> Reading and validating configuration files written in TOML format, specifically for custom styles (<code>StyleParser</code>) and annotations (<code>AnnotationParser</code>). These parsers translate the TOML definitions into structured Pydantic models used by the Scene and Rendering systems.</li>
<li><strong>Validation:</strong> Performing basic checks on input files (e.g., existence, basic format validation) before attempting full parsing.</li>
<li><strong>Error Handling:</strong> Defining specific exception types related to file reading, parsing, and validation errors.</li>
</ol>
<hr />
<h2 id="structure-parser">Structure Parser</h2>
<p>Handles reading and parsing protein structure files (PDB, mmCIF).</p>


<div class="doc doc-object doc-class">



<a id="flatprot.io.GemmiStructureParser"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flatprot.io.structure.StructureParser">StructureParser</span></code></p>








              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/structure_gemmi_adapter.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GemmiStructureParser</span><span class="p">(</span><span class="n">StructureParser</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">parse_structure</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">structure_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">secondary_structure_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Structure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Main entry point for structure parsing&quot;&quot;&quot;</span>
        <span class="c1"># 1. Parse structure</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_structure_file</span><span class="p">(</span><span class="n">structure_file</span><span class="p">)</span>

        <span class="c1"># 2. Process each chain</span>
        <span class="n">chains</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">structure</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="c1"># Extract basic chain data</span>
            <span class="n">chain_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_chain_data</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>
            <span class="c1"># Get secondary structure</span>
            <span class="n">ss_regions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_secondary_structure</span><span class="p">(</span>
                <span class="n">structure</span><span class="p">,</span> <span class="n">secondary_structure_file</span>
            <span class="p">)</span>

            <span class="n">chain_obj</span> <span class="o">=</span> <span class="n">Chain</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">chain_data</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">ss_regions</span><span class="p">:</span>
                <span class="n">chain_obj</span><span class="o">.</span><span class="n">add_secondary_structure</span><span class="p">(</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">region</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">region</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chain_obj</span><span class="p">)</span>

        <span class="c1"># Assign structure ID from filename stem</span>
        <span class="n">structure_id</span> <span class="o">=</span> <span class="n">structure_file</span><span class="o">.</span><span class="n">stem</span>
        <span class="k">return</span> <span class="n">Structure</span><span class="p">(</span><span class="n">chains</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">structure_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_structure_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structure_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Structure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse structure from file using gemmi&quot;&quot;&quot;</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">read_structure</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">structure_file</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">structure</span>

    <span class="k">def</span> <span class="nf">_parse_chain_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chain</span><span class="p">:</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Chain</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract basic chain data using gemmi&quot;&quot;&quot;</span>
        <span class="n">residue_indices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">residue_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">get_ca_coordinates</span><span class="p">(</span><span class="n">residue</span><span class="p">:</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Residue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">residue</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;CA&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">atom</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">atom</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">atom</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="p">])</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">:</span>
            <span class="n">coordinate</span> <span class="o">=</span> <span class="n">get_ca_coordinates</span><span class="p">(</span><span class="n">residue</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">coordinate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coordinate</span><span class="p">)</span>
                <span class="n">residue_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">seqid</span><span class="o">.</span><span class="n">num</span><span class="p">)</span>
                <span class="n">residue</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">find_tabulated_residue</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">one_letter_code</span>
                <span class="n">residue</span> <span class="o">=</span> <span class="s2">&quot;X&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">residue</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="k">else</span> <span class="n">residue</span>
                <span class="n">residue_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResidueType</span><span class="p">(</span><span class="n">residue</span><span class="p">))</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">residue_indices</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">residue_indices</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">residue_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">residue_indices</span><span class="p">,</span>
            <span class="s2">&quot;residues&quot;</span><span class="p">:</span> <span class="n">residue_names</span><span class="p">,</span>
            <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_get_secondary_structure</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">structure</span><span class="p">:</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Structure</span><span class="p">,</span>
        <span class="n">secondary_structure_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">SecondaryStructureType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="n">secondary_structure_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">parse_dssp</span><span class="p">(</span><span class="n">secondary_structure_file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_secondary_structure_cif</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_secondary_structure_cif</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">structure</span><span class="p">:</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Structure</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">SecondaryStructureType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get secondary structure from gemmi structure&quot;&quot;&quot;</span>
        <span class="n">ss_regions</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Extract helices and sheets from gemmi structure</span>
        <span class="k">for</span> <span class="n">helix</span> <span class="ow">in</span> <span class="n">structure</span><span class="o">.</span><span class="n">helices</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">helix</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">res_id</span><span class="o">.</span><span class="n">seqid</span><span class="o">.</span><span class="n">num</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">helix</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">res_id</span><span class="o">.</span><span class="n">seqid</span><span class="o">.</span><span class="n">num</span>
            <span class="n">ss_regions</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">SecondaryStructureType</span><span class="o">.</span><span class="n">HELIX</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">sheet</span> <span class="ow">in</span> <span class="n">structure</span><span class="o">.</span><span class="n">sheets</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">strand</span> <span class="ow">in</span> <span class="n">sheet</span><span class="o">.</span><span class="n">strands</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">strand</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">res_id</span><span class="o">.</span><span class="n">seqid</span><span class="o">.</span><span class="n">num</span>
                <span class="n">end</span> <span class="o">=</span> <span class="n">strand</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">res_id</span><span class="o">.</span><span class="n">seqid</span><span class="o">.</span><span class="n">num</span>
                <span class="n">ss_regions</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">SecondaryStructureType</span><span class="o">.</span><span class="n">SHEET</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">ss_regions</span>

    <span class="k">def</span> <span class="nf">save_structure</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">structure</span><span class="p">:</span> <span class="n">Structure</span><span class="p">,</span> <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">separate_chains</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save structure using gemmi&quot;&quot;&quot;</span>
        <span class="n">gemmi_structure</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Structure</span><span class="p">()</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">chain_id</span><span class="p">,</span> <span class="n">chain_data</span> <span class="ow">in</span> <span class="n">structure</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">chain</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Chain</span><span class="p">(</span><span class="n">chain_id</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">residue_idx</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">coord</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                <span class="nb">zip</span><span class="p">(</span><span class="n">chain_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">chain_data</span><span class="o">.</span><span class="n">residues</span><span class="p">,</span> <span class="n">chain_data</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">gemmi_res</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Residue</span><span class="p">()</span>
                <span class="n">gemmi_res</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">residue</span><span class="o">.</span><span class="n">name</span>
                <span class="n">gemmi_res</span><span class="o">.</span><span class="n">seqid</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">SeqId</span><span class="p">(</span><span class="n">residue_idx</span><span class="p">)</span>

                <span class="n">ca</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Atom</span><span class="p">()</span>
                <span class="n">ca</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;CA&quot;</span>
                <span class="n">ca</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Position</span><span class="p">(</span><span class="o">*</span><span class="n">coord</span><span class="p">)</span>
                <span class="n">ca</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
                <span class="n">gemmi_res</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">ca</span><span class="p">)</span>

                <span class="n">chain</span><span class="o">.</span><span class="n">add_residue</span><span class="p">(</span><span class="n">gemmi_res</span><span class="p">)</span>

            <span class="n">model</span><span class="o">.</span><span class="n">add_chain</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>

        <span class="n">gemmi_structure</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">gemmi_structure</span><span class="o">.</span><span class="n">write_pdb</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_file</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="flatprot.io.GemmiStructureParser.parse_structure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_structure</span><span class="p">(</span><span class="n">structure_file</span><span class="p">,</span> <span class="n">secondary_structure_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Main entry point for structure parsing</p>


            <details class="quote">
              <summary>Source code in <code>src/flatprot/io/structure_gemmi_adapter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_structure</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">structure_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">secondary_structure_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Structure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Main entry point for structure parsing&quot;&quot;&quot;</span>
    <span class="c1"># 1. Parse structure</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_structure_file</span><span class="p">(</span><span class="n">structure_file</span><span class="p">)</span>

    <span class="c1"># 2. Process each chain</span>
    <span class="n">chains</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">structure</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="c1"># Extract basic chain data</span>
        <span class="n">chain_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_chain_data</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>
        <span class="c1"># Get secondary structure</span>
        <span class="n">ss_regions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_secondary_structure</span><span class="p">(</span>
            <span class="n">structure</span><span class="p">,</span> <span class="n">secondary_structure_file</span>
        <span class="p">)</span>

        <span class="n">chain_obj</span> <span class="o">=</span> <span class="n">Chain</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">chain_data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">ss_regions</span><span class="p">:</span>
            <span class="n">chain_obj</span><span class="o">.</span><span class="n">add_secondary_structure</span><span class="p">(</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">region</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">region</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">chains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chain_obj</span><span class="p">)</span>

    <span class="c1"># Assign structure ID from filename stem</span>
    <span class="n">structure_id</span> <span class="o">=</span> <span class="n">structure_file</span><span class="o">.</span><span class="n">stem</span>
    <span class="k">return</span> <span class="n">Structure</span><span class="p">(</span><span class="n">chains</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">structure_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="flatprot.io.GemmiStructureParser.save_structure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_structure</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">separate_chains</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Save structure using gemmi</p>


            <details class="quote">
              <summary>Source code in <code>src/flatprot/io/structure_gemmi_adapter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save_structure</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">structure</span><span class="p">:</span> <span class="n">Structure</span><span class="p">,</span> <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">separate_chains</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save structure using gemmi&quot;&quot;&quot;</span>
    <span class="n">gemmi_structure</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Structure</span><span class="p">()</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">chain_id</span><span class="p">,</span> <span class="n">chain_data</span> <span class="ow">in</span> <span class="n">structure</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">chain</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Chain</span><span class="p">(</span><span class="n">chain_id</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">residue_idx</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">coord</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span><span class="n">chain_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">chain_data</span><span class="o">.</span><span class="n">residues</span><span class="p">,</span> <span class="n">chain_data</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">gemmi_res</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Residue</span><span class="p">()</span>
            <span class="n">gemmi_res</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">residue</span><span class="o">.</span><span class="n">name</span>
            <span class="n">gemmi_res</span><span class="o">.</span><span class="n">seqid</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">SeqId</span><span class="p">(</span><span class="n">residue_idx</span><span class="p">)</span>

            <span class="n">ca</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Atom</span><span class="p">()</span>
            <span class="n">ca</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;CA&quot;</span>
            <span class="n">ca</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Position</span><span class="p">(</span><span class="o">*</span><span class="n">coord</span><span class="p">)</span>
            <span class="n">ca</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
            <span class="n">gemmi_res</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">ca</span><span class="p">)</span>

            <span class="n">chain</span><span class="o">.</span><span class="n">add_residue</span><span class="p">(</span><span class="n">gemmi_res</span><span class="p">)</span>

        <span class="n">model</span><span class="o">.</span><span class="n">add_chain</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>

    <span class="n">gemmi_structure</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">gemmi_structure</span><span class="o">.</span><span class="n">write_pdb</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_file</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>options:
show_root_heading: true
members_order: source</p>
<h2 id="style-parser">Style Parser</h2>
<p>Parses TOML files defining custom styles for structure elements.</p>


<div class="doc doc-object doc-class">



<a id="flatprot.io.styles.StyleParser"></a>
    <div class="doc doc-contents first">


        <p>Parser for TOML style files focusing on structure elements and connections.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/styles.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StyleParser</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parser for TOML style files focusing on structure elements and connections.&quot;&quot;&quot;</span>

    <span class="c1"># Define known sections and their corresponding Pydantic models</span>
    <span class="n">KNOWN_SECTIONS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;helix&quot;</span><span class="p">:</span> <span class="n">HelixStyle</span><span class="p">,</span>
        <span class="s2">&quot;sheet&quot;</span><span class="p">:</span> <span class="n">SheetStyle</span><span class="p">,</span>
        <span class="s2">&quot;coil&quot;</span><span class="p">:</span> <span class="n">CoilStyle</span><span class="p">,</span>
        <span class="s2">&quot;connection&quot;</span><span class="p">:</span> <span class="n">ConnectionStyle</span><span class="p">,</span>
        <span class="s2">&quot;position_annotation&quot;</span><span class="p">:</span> <span class="n">PositionAnnotationStyle</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the style parser.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path: Path to the TOML style file</span>

<span class="sd">        Raises:</span>
<span class="sd">            StyleFileNotFoundError: If the file doesn&#39;t exist</span>
<span class="sd">            InvalidTomlError: If the TOML is malformed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">StyleFileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Style file not found: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">raw_style_data</span> <span class="o">=</span> <span class="n">toml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">toml</span><span class="o">.</span><span class="n">TomlDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidTomlError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid TOML format: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_structure</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_validate_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks for unknown top-level sections in the style file.&quot;&quot;&quot;</span>
        <span class="n">unknown_sections</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">section</span>
            <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_style_data</span>
            <span class="k">if</span> <span class="n">section</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">KNOWN_SECTIONS</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="n">unknown_sections</span><span class="p">:</span>
            <span class="c1"># This is just a warning, not an error</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Warning: Unknown style sections found and ignored: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unknown_sections</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">BaseStructureStyle</span><span class="p">,</span> <span class="n">ConnectionStyle</span><span class="p">,</span> <span class="n">PositionAnnotationStyle</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parses the known sections from the TOML file into Pydantic style objects.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary mapping section names (&#39;helix&#39;, &#39;sheet&#39;, &#39;coil&#39;, &#39;connection&#39;, &#39;position_annotation&#39;)</span>
<span class="sd">            to their corresponding Pydantic style model instances.</span>

<span class="sd">        Raises:</span>
<span class="sd">            StyleValidationError: If any style section has invalid data according to</span>
<span class="sd">                                  its Pydantic model.</span>
<span class="sd">            StyleParsingError: For other general parsing issues.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parsed_styles</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span>
            <span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">BaseStructureStyle</span><span class="p">,</span> <span class="n">ConnectionStyle</span><span class="p">,</span> <span class="n">PositionAnnotationStyle</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">section_name</span><span class="p">,</span> <span class="n">StyleModelClass</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">KNOWN_SECTIONS</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">section_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_style_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">section_name</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">section_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Section not present in the file, skip it (will use default later)</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">section_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">StyleValidationError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid format for section &#39;</span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">&#39;. Expected a table (dictionary), got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">section_data</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Pydantic handles validation and type conversion (including Color)</span>
                <span class="n">style_instance</span> <span class="o">=</span> <span class="n">StyleModelClass</span><span class="p">(</span><span class="o">**</span><span class="n">section_data</span><span class="p">)</span>
                <span class="n">parsed_styles</span><span class="p">[</span><span class="n">section_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">style_instance</span>
            <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># Provide more context for validation errors</span>
                <span class="n">error_details</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">errors</span><span class="p">()</span>
                <span class="n">error_msgs</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">err</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">err</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">error_details</span>
                <span class="p">]</span>
                <span class="k">raise</span> <span class="n">StyleValidationError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid style definition in section &#39;</span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">&#39;:</span><span class="se">\\</span><span class="s2">n&quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">error_msgs</span><span class="p">)</span>
                <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># Catch other potential errors during instantiation</span>
                <span class="k">raise</span> <span class="n">StyleParsingError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Error processing style section &#39;</span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

        <span class="k">return</span> <span class="n">parsed_styles</span>

    <span class="k">def</span> <span class="nf">get_element_styles</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">BaseStructureStyle</span><span class="p">,</span> <span class="n">ConnectionStyle</span><span class="p">,</span> <span class="n">PositionAnnotationStyle</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse and return the element styles defined in the TOML file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict mapping element type names (&#39;helix&#39;, &#39;sheet&#39;, &#39;coil&#39;, &#39;connection&#39;, &#39;position_annotation&#39;)</span>
<span class="sd">            to their parsed Pydantic style objects. Sections not found in the TOML</span>
<span class="sd">            file will be omitted from the dictionary.</span>

<span class="sd">        Raises:</span>
<span class="sd">            StyleValidationError: If validation of any section fails.</span>
<span class="sd">            StyleParsingError: For general parsing issues.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">StyleValidationError</span><span class="p">,</span> <span class="n">StyleParsingError</span><span class="p">):</span>
            <span class="c1"># Re-raise exceptions from parse</span>
            <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Catch unexpected errors during the overall process</span>
            <span class="k">raise</span> <span class="n">StyleParsingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to get element styles: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

    <span class="k">def</span> <span class="nf">get_raw_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the raw, unprocessed style data loaded from the TOML file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict containing the raw parsed TOML data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_style_data</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="flatprot.io.styles.StyleParser.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Initialize the style parser.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>file_path</code></b>
                  (<code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]</code>)
              
              <div class="doc-md-description">
                <p>Path to the TOML style file</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="StyleFileNotFoundError (flatprot.io.errors.StyleFileNotFoundError)" href="#flatprot.io.errors.StyleFileNotFoundError">StyleFileNotFoundError</a></code>
              
              <div class="doc-md-description">
                <p>If the file doesn't exist</p>
              </div>
            </li>
            <li>
                  <code><a class="autorefs autorefs-internal" title="InvalidTomlError (flatprot.io.errors.InvalidTomlError)" href="#flatprot.io.errors.InvalidTomlError">InvalidTomlError</a></code>
              
              <div class="doc-md-description">
                <p>If the TOML is malformed</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/io/styles.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the style parser.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path: Path to the TOML style file</span>

<span class="sd">    Raises:</span>
<span class="sd">        StyleFileNotFoundError: If the file doesn&#39;t exist</span>
<span class="sd">        InvalidTomlError: If the TOML is malformed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">StyleFileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Style file not found: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">raw_style_data</span> <span class="o">=</span> <span class="n">toml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">toml</span><span class="o">.</span><span class="n">TomlDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidTomlError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid TOML format: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_structure</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="flatprot.io.styles.StyleParser.get_element_styles" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_element_styles</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Parse and return the element styles defined in the TOML file.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="flatprot.scene.structure.BaseStructureStyle" href="../scene/#flatprot.scene.structure.base_structure.BaseStructureStyle">BaseStructureStyle</a>, <span title="flatprot.scene.connection.ConnectionStyle">ConnectionStyle</span>, <span title="flatprot.scene.annotation.PositionAnnotationStyle">PositionAnnotationStyle</span>]]</code>
              
              <div class="doc-md-description">
                <p>Dict mapping element type names ('helix', 'sheet', 'coil', 'connection', 'position_annotation')</p>
              </div>
            </li>
            <li>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="flatprot.scene.structure.BaseStructureStyle" href="../scene/#flatprot.scene.structure.base_structure.BaseStructureStyle">BaseStructureStyle</a>, <span title="flatprot.scene.connection.ConnectionStyle">ConnectionStyle</span>, <span title="flatprot.scene.annotation.PositionAnnotationStyle">PositionAnnotationStyle</span>]]</code>
              
              <div class="doc-md-description">
                <p>to their parsed Pydantic style objects. Sections not found in the TOML</p>
              </div>
            </li>
            <li>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="flatprot.scene.structure.BaseStructureStyle" href="../scene/#flatprot.scene.structure.base_structure.BaseStructureStyle">BaseStructureStyle</a>, <span title="flatprot.scene.connection.ConnectionStyle">ConnectionStyle</span>, <span title="flatprot.scene.annotation.PositionAnnotationStyle">PositionAnnotationStyle</span>]]</code>
              
              <div class="doc-md-description">
                <p>file will be omitted from the dictionary.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="StyleValidationError (flatprot.io.errors.StyleValidationError)" href="#flatprot.io.errors.StyleValidationError">StyleValidationError</a></code>
              
              <div class="doc-md-description">
                <p>If validation of any section fails.</p>
              </div>
            </li>
            <li>
                  <code><a class="autorefs autorefs-internal" title="StyleParsingError (flatprot.io.errors.StyleParsingError)" href="#flatprot.io.errors.StyleParsingError">StyleParsingError</a></code>
              
              <div class="doc-md-description">
                <p>For general parsing issues.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/io/styles.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_element_styles</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">BaseStructureStyle</span><span class="p">,</span> <span class="n">ConnectionStyle</span><span class="p">,</span> <span class="n">PositionAnnotationStyle</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse and return the element styles defined in the TOML file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict mapping element type names (&#39;helix&#39;, &#39;sheet&#39;, &#39;coil&#39;, &#39;connection&#39;, &#39;position_annotation&#39;)</span>
<span class="sd">        to their parsed Pydantic style objects. Sections not found in the TOML</span>
<span class="sd">        file will be omitted from the dictionary.</span>

<span class="sd">    Raises:</span>
<span class="sd">        StyleValidationError: If validation of any section fails.</span>
<span class="sd">        StyleParsingError: For general parsing issues.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">StyleValidationError</span><span class="p">,</span> <span class="n">StyleParsingError</span><span class="p">):</span>
        <span class="c1"># Re-raise exceptions from parse</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Catch unexpected errors during the overall process</span>
        <span class="k">raise</span> <span class="n">StyleParsingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to get element styles: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="flatprot.io.styles.StyleParser.get_raw_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_raw_data</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Return the raw, unprocessed style data loaded from the TOML file.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
              
              <div class="doc-md-description">
                <p>Dict containing the raw parsed TOML data.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/io/styles.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_raw_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the raw, unprocessed style data loaded from the TOML file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict containing the raw parsed TOML data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_style_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="flatprot.io.styles.StyleParser.parse" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Parses the known sections from the TOML file into Pydantic style objects.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="flatprot.scene.structure.BaseStructureStyle" href="../scene/#flatprot.scene.structure.base_structure.BaseStructureStyle">BaseStructureStyle</a>, <span title="flatprot.scene.connection.ConnectionStyle">ConnectionStyle</span>, <span title="flatprot.scene.annotation.PositionAnnotationStyle">PositionAnnotationStyle</span>]]</code>
              
              <div class="doc-md-description">
                <p>A dictionary mapping section names ('helix', 'sheet', 'coil', 'connection', 'position_annotation')</p>
              </div>
            </li>
            <li>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="flatprot.scene.structure.BaseStructureStyle" href="../scene/#flatprot.scene.structure.base_structure.BaseStructureStyle">BaseStructureStyle</a>, <span title="flatprot.scene.connection.ConnectionStyle">ConnectionStyle</span>, <span title="flatprot.scene.annotation.PositionAnnotationStyle">PositionAnnotationStyle</span>]]</code>
              
              <div class="doc-md-description">
                <p>to their corresponding Pydantic style model instances.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="StyleValidationError (flatprot.io.errors.StyleValidationError)" href="#flatprot.io.errors.StyleValidationError">StyleValidationError</a></code>
              
              <div class="doc-md-description">
                <p>If any style section has invalid data according to
                  its Pydantic model.</p>
              </div>
            </li>
            <li>
                  <code><a class="autorefs autorefs-internal" title="StyleParsingError (flatprot.io.errors.StyleParsingError)" href="#flatprot.io.errors.StyleParsingError">StyleParsingError</a></code>
              
              <div class="doc-md-description">
                <p>For other general parsing issues.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/io/styles.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">BaseStructureStyle</span><span class="p">,</span> <span class="n">ConnectionStyle</span><span class="p">,</span> <span class="n">PositionAnnotationStyle</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses the known sections from the TOML file into Pydantic style objects.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary mapping section names (&#39;helix&#39;, &#39;sheet&#39;, &#39;coil&#39;, &#39;connection&#39;, &#39;position_annotation&#39;)</span>
<span class="sd">        to their corresponding Pydantic style model instances.</span>

<span class="sd">    Raises:</span>
<span class="sd">        StyleValidationError: If any style section has invalid data according to</span>
<span class="sd">                              its Pydantic model.</span>
<span class="sd">        StyleParsingError: For other general parsing issues.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parsed_styles</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">BaseStructureStyle</span><span class="p">,</span> <span class="n">ConnectionStyle</span><span class="p">,</span> <span class="n">PositionAnnotationStyle</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">section_name</span><span class="p">,</span> <span class="n">StyleModelClass</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">KNOWN_SECTIONS</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">section_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_style_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">section_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">section_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Section not present in the file, skip it (will use default later)</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">section_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">StyleValidationError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid format for section &#39;</span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">&#39;. Expected a table (dictionary), got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">section_data</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Pydantic handles validation and type conversion (including Color)</span>
            <span class="n">style_instance</span> <span class="o">=</span> <span class="n">StyleModelClass</span><span class="p">(</span><span class="o">**</span><span class="n">section_data</span><span class="p">)</span>
            <span class="n">parsed_styles</span><span class="p">[</span><span class="n">section_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">style_instance</span>
        <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Provide more context for validation errors</span>
            <span class="n">error_details</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">errors</span><span class="p">()</span>
            <span class="n">error_msgs</span> <span class="o">=</span> <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">err</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">err</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">error_details</span>
            <span class="p">]</span>
            <span class="k">raise</span> <span class="n">StyleValidationError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid style definition in section &#39;</span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">&#39;:</span><span class="se">\\</span><span class="s2">n&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">error_msgs</span><span class="p">)</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Catch other potential errors during instantiation</span>
            <span class="k">raise</span> <span class="n">StyleParsingError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Error processing style section &#39;</span><span class="si">{</span><span class="n">section_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

    <span class="k">return</span> <span class="n">parsed_styles</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>options:
show_root_heading: true
members_order: source</p>
<h2 id="annotation-parser">Annotation Parser</h2>
<p>Parses TOML files defining annotations (points, lines, areas) and their inline styles.</p>


<div class="doc doc-object doc-class">



<a id="flatprot.io.annotations.AnnotationParser"></a>
    <div class="doc doc-contents first">


        <p>Parses annotation files in TOML format with optional inline styles.</p>
<p>Creates fully initialized PointAnnotation, LineAnnotation, or AreaAnnotation
objects from the <code>flatprot.scene.annotations</code> module.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/annotations.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AnnotationParser</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses annotation files in TOML format with optional inline styles.</span>

<span class="sd">    Creates fully initialized PointAnnotation, LineAnnotation, or AreaAnnotation</span>
<span class="sd">    objects from the `flatprot.scene.annotations` module.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the parser with the path to the annotation file.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path: Path to the TOML file containing annotations.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AnnotationFileNotFoundError: If the file does not exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="c1"># Check file existence</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">AnnotationFileNotFoundError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">))</span>

        <span class="c1"># Map annotation type strings to their respective parsing methods</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parsers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span>
            <span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">AnnotationObjectType</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_point_annotation</span><span class="p">,</span>
            <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_line_annotation</span><span class="p">,</span>
            <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_area_annotation</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_parse_inline_style</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">style_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
        <span class="n">StyleModel</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">BaseAnnotationStyle</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BaseAnnotationStyle</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parses the inline style dictionary using the provided Pydantic model.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">style_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">style_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                <span class="n">context</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;&#39;style&#39; entry must be a table (dictionary), got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">style_dict</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">style_instance</span> <span class="o">=</span> <span class="n">StyleModel</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">style_dict</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">style_instance</span>
        <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error_details</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">errors</span><span class="p">()</span>
            <span class="n">error_msgs</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">err</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">err</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">error_details</span><span class="p">]</span>
            <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                <span class="n">context</span><span class="p">,</span> <span class="s2">&quot;Invalid style definition:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">error_msgs</span><span class="p">)</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AnnotationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">: Error creating style object: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

    <span class="k">def</span> <span class="nf">_parse_point_annotation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">anno_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">anno_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PointAnnotation</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parses a point annotation entry.&quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">anno_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">)</span>
        <span class="n">index_str</span> <span class="o">=</span> <span class="n">anno_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
        <span class="n">style_dict</span> <span class="o">=</span> <span class="n">anno_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;style&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">index_str</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                <span class="n">context</span><span class="p">,</span> <span class="s2">&quot;Missing &#39;index&#39; field for &#39;point&#39; annotation.&quot;</span>
            <span class="p">)</span>

        <span class="n">target_coord</span> <span class="o">=</span> <span class="n">_parse_residue_coordinate</span><span class="p">(</span><span class="n">index_str</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="n">style_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_inline_style</span><span class="p">(</span>
            <span class="n">style_dict</span><span class="p">,</span> <span class="n">PointAnnotationStyle</span><span class="p">,</span> <span class="n">context</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">PointAnnotation</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="n">anno_id</span><span class="p">,</span>
            <span class="n">target</span><span class="o">=</span><span class="n">target_coord</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">cast</span><span class="p">(</span><span class="n">Optional</span><span class="p">[</span><span class="n">PointAnnotationStyle</span><span class="p">],</span> <span class="n">style_instance</span><span class="p">),</span>
            <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_line_annotation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">anno_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">anno_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LineAnnotation</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parses a line annotation entry.&quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">anno_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">)</span>
        <span class="n">indices_list</span> <span class="o">=</span> <span class="n">anno_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;indices&quot;</span><span class="p">)</span>
        <span class="n">style_dict</span> <span class="o">=</span> <span class="n">anno_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;style&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices_list</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                <span class="n">context</span><span class="p">,</span>
                <span class="s2">&quot;Field &#39;indices&#39; for &#39;line&#39; annotation must be a list of exactly two coordinate strings (e.g., [&#39;A:10&#39;, &#39;A:20&#39;]).&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">target_coords</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">_parse_residue_coordinate</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">, index </span><span class="si">{</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">indices_list</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">style_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_inline_style</span><span class="p">(</span>
            <span class="n">style_dict</span><span class="p">,</span> <span class="n">LineAnnotationStyle</span><span class="p">,</span> <span class="n">context</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">LineAnnotation</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="n">anno_id</span><span class="p">,</span>
            <span class="n">start_coordinate</span><span class="o">=</span><span class="n">target_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">end_coordinate</span><span class="o">=</span><span class="n">target_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">style</span><span class="o">=</span><span class="n">cast</span><span class="p">(</span>
                <span class="n">Optional</span><span class="p">[</span><span class="n">LineAnnotationStyle</span><span class="p">],</span> <span class="n">style_instance</span>
            <span class="p">),</span>  <span class="c1"># Cast for type checker</span>
            <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_area_annotation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">anno_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">anno_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AreaAnnotation</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parses an area annotation entry.&quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">anno_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">)</span>
        <span class="n">range_str</span> <span class="o">=</span> <span class="n">anno_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;range&quot;</span><span class="p">)</span>
        <span class="n">style_dict</span> <span class="o">=</span> <span class="n">anno_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;style&quot;</span><span class="p">)</span>
        <span class="c1"># AreaAnnotation currently only supports range, not list of indices</span>

        <span class="k">if</span> <span class="n">range_str</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                <span class="n">context</span><span class="p">,</span> <span class="s2">&quot;Missing &#39;range&#39; field for &#39;area&#39; annotation.&quot;</span>
            <span class="p">)</span>

        <span class="n">target_range</span> <span class="o">=</span> <span class="n">_parse_residue_range</span><span class="p">(</span><span class="n">range_str</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="n">target_range_set</span> <span class="o">=</span> <span class="n">ResidueRangeSet</span><span class="p">([</span><span class="n">target_range</span><span class="p">])</span>
        <span class="n">style_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_inline_style</span><span class="p">(</span>
            <span class="n">style_dict</span><span class="p">,</span> <span class="n">AreaAnnotationStyle</span><span class="p">,</span> <span class="n">context</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">AreaAnnotation</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="n">anno_id</span><span class="p">,</span>
            <span class="n">residue_range_set</span><span class="o">=</span><span class="n">target_range_set</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">cast</span><span class="p">(</span>
                <span class="n">Optional</span><span class="p">[</span><span class="n">AreaAnnotationStyle</span><span class="p">],</span> <span class="n">style_instance</span>
            <span class="p">),</span>  <span class="c1"># Cast for type checker</span>
            <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">AnnotationObjectType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse the annotation file and create annotation objects.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of parsed annotation objects (PointAnnotation, LineAnnotation, AreaAnnotation).</span>

<span class="sd">        Raises:</span>
<span class="sd">            MalformedAnnotationError: If the TOML file is malformed, missing required structure,</span>
<span class="sd">                                      contains invalid formats, or style validation fails.</span>
<span class="sd">            AnnotationError: For other general parsing issues.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Parse TOML content</span>
            <span class="n">raw_data</span> <span class="o">=</span> <span class="n">toml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">toml</span><span class="o">.</span><span class="n">TomlDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;File: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Invalid TOML syntax: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AnnotationError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Error loading TOML file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;annotations&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">raw_data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;File: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;Missing top-level &#39;annotations&#39; list.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s2">&quot;annotations&quot;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;File: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;annotations&#39; key must contain a list.&quot;</span>
            <span class="p">)</span>

        <span class="n">parsed_annotations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AnnotationObjectType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">anno_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s2">&quot;annotations&quot;</span><span class="p">]):</span>
            <span class="n">context</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;File: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">, Annotation #</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">anno_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                        <span class="n">context</span><span class="p">,</span> <span class="s2">&quot;Annotation entry must be a table (dictionary).&quot;</span>
                    <span class="p">)</span>

                <span class="n">anno_type</span> <span class="o">=</span> <span class="n">anno_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">anno_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                        <span class="n">context</span><span class="p">,</span>
                        <span class="sa">f</span><span class="s2">&quot;Missing or invalid &#39;type&#39; field. Expected a string, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">anno_type</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

                <span class="c1"># Look up the parser function based on the type</span>
                <span class="n">parser_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">anno_type</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">parser_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                        <span class="n">context</span><span class="p">,</span>
                        <span class="sa">f</span><span class="s2">&quot;Unknown annotation &#39;type&#39;: &#39;</span><span class="si">{</span><span class="n">anno_type</span><span class="si">}</span><span class="s2">&#39;. Must be one of </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parsers</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

                <span class="c1"># Check for optional user-provided ID</span>
                <span class="n">provided_id</span> <span class="o">=</span> <span class="n">anno_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">provided_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">provided_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                        <span class="n">anno_id</span> <span class="o">=</span> <span class="n">provided_id</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                            <span class="n">context</span><span class="p">,</span>
                            <span class="sa">f</span><span class="s2">&quot;Optional &#39;id&#39; field must be a string, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">provided_id</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
                        <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Generate ID if not provided</span>
                    <span class="n">anno_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;annotation_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">anno_type</span><span class="si">}</span><span class="s2">&quot;</span>

                <span class="c1"># Call the specific parser method</span>
                <span class="n">annotation_object</span> <span class="o">=</span> <span class="n">parser_func</span><span class="p">(</span><span class="n">anno_data</span><span class="p">,</span> <span class="n">anno_id</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
                <span class="n">parsed_annotations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">annotation_object</span><span class="p">)</span>

            <span class="k">except</span> <span class="p">(</span><span class="n">MalformedAnnotationError</span><span class="p">,</span> <span class="n">AnnotationError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">e</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">AnnotationError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Unexpected error processing annotation in </span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

        <span class="k">return</span> <span class="n">parsed_annotations</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="flatprot.io.annotations.AnnotationParser.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Initialize the parser with the path to the annotation file.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>file_path</code></b>
                  (<code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]</code>)
              
              <div class="doc-md-description">
                <p>Path to the TOML file containing annotations.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="AnnotationFileNotFoundError (flatprot.io.errors.AnnotationFileNotFoundError)" href="#flatprot.io.errors.AnnotationFileNotFoundError">AnnotationFileNotFoundError</a></code>
              
              <div class="doc-md-description">
                <p>If the file does not exist.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/io/annotations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the parser with the path to the annotation file.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path: Path to the TOML file containing annotations.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AnnotationFileNotFoundError: If the file does not exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="c1"># Check file existence</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">AnnotationFileNotFoundError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">))</span>

    <span class="c1"># Map annotation type strings to their respective parsing methods</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parsers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">AnnotationObjectType</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_point_annotation</span><span class="p">,</span>
        <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_line_annotation</span><span class="p">,</span>
        <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_area_annotation</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="flatprot.io.annotations.AnnotationParser.parse" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Parse the annotation file and create annotation objects.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[<span title="flatprot.io.annotations.AnnotationObjectType">AnnotationObjectType</span>]</code>
              
              <div class="doc-md-description">
                <p>List of parsed annotation objects (PointAnnotation, LineAnnotation, AreaAnnotation).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="MalformedAnnotationError (flatprot.io.errors.MalformedAnnotationError)" href="#flatprot.io.errors.MalformedAnnotationError">MalformedAnnotationError</a></code>
              
              <div class="doc-md-description">
                <p>If the TOML file is malformed, missing required structure,
                      contains invalid formats, or style validation fails.</p>
              </div>
            </li>
            <li>
                  <code><a class="autorefs autorefs-internal" title="AnnotationError (flatprot.io.errors.AnnotationError)" href="#flatprot.io.errors.AnnotationError">AnnotationError</a></code>
              
              <div class="doc-md-description">
                <p>For other general parsing issues.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/io/annotations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">AnnotationObjectType</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse the annotation file and create annotation objects.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of parsed annotation objects (PointAnnotation, LineAnnotation, AreaAnnotation).</span>

<span class="sd">    Raises:</span>
<span class="sd">        MalformedAnnotationError: If the TOML file is malformed, missing required structure,</span>
<span class="sd">                                  contains invalid formats, or style validation fails.</span>
<span class="sd">        AnnotationError: For other general parsing issues.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Parse TOML content</span>
        <span class="n">raw_data</span> <span class="o">=</span> <span class="n">toml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">toml</span><span class="o">.</span><span class="n">TomlDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;File: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Invalid TOML syntax: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AnnotationError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Error loading TOML file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;annotations&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">raw_data</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;File: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;Missing top-level &#39;annotations&#39; list.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s2">&quot;annotations&quot;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;File: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;annotations&#39; key must contain a list.&quot;</span>
        <span class="p">)</span>

    <span class="n">parsed_annotations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AnnotationObjectType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">anno_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s2">&quot;annotations&quot;</span><span class="p">]):</span>
        <span class="n">context</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;File: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">, Annotation #</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">anno_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                    <span class="n">context</span><span class="p">,</span> <span class="s2">&quot;Annotation entry must be a table (dictionary).&quot;</span>
                <span class="p">)</span>

            <span class="n">anno_type</span> <span class="o">=</span> <span class="n">anno_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">anno_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                    <span class="n">context</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;Missing or invalid &#39;type&#39; field. Expected a string, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">anno_type</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="c1"># Look up the parser function based on the type</span>
            <span class="n">parser_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">anno_type</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">parser_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                    <span class="n">context</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;Unknown annotation &#39;type&#39;: &#39;</span><span class="si">{</span><span class="n">anno_type</span><span class="si">}</span><span class="s2">&#39;. Must be one of </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parsers</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="c1"># Check for optional user-provided ID</span>
            <span class="n">provided_id</span> <span class="o">=</span> <span class="n">anno_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">provided_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">provided_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">anno_id</span> <span class="o">=</span> <span class="n">provided_id</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">MalformedAnnotationError</span><span class="p">(</span>
                        <span class="n">context</span><span class="p">,</span>
                        <span class="sa">f</span><span class="s2">&quot;Optional &#39;id&#39; field must be a string, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">provided_id</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Generate ID if not provided</span>
                <span class="n">anno_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;annotation_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">anno_type</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="c1"># Call the specific parser method</span>
            <span class="n">annotation_object</span> <span class="o">=</span> <span class="n">parser_func</span><span class="p">(</span><span class="n">anno_data</span><span class="p">,</span> <span class="n">anno_id</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
            <span class="n">parsed_annotations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">annotation_object</span><span class="p">)</span>

        <span class="k">except</span> <span class="p">(</span><span class="n">MalformedAnnotationError</span><span class="p">,</span> <span class="n">AnnotationError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AnnotationError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unexpected error processing annotation in </span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

    <span class="k">return</span> <span class="n">parsed_annotations</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>options:
show_root_heading: true
members_order: source</p>
<h2 id="file-validation">File Validation</h2>
<p>Utility functions for validating input files.</p>


<div class="doc doc-object doc-function">



<a id="flatprot.io.validate_structure_file"></a>
    <div class="doc doc-contents first">

        <p>Validate that the file exists and is a valid PDB or CIF format.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>path</code></b>
                  (<code><span title="pathlib.Path">Path</span></code>)
              
              <div class="doc-md-description">
                <p>Path to the structure file</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="StructureFileNotFoundError (flatprot.io.errors.StructureFileNotFoundError)" href="#flatprot.io.errors.StructureFileNotFoundError">StructureFileNotFoundError</a></code>
              
              <div class="doc-md-description">
                <p>If the file does not exist</p>
              </div>
            </li>
            <li>
                  <code><a class="autorefs autorefs-internal" title="InvalidStructureError (flatprot.io.errors.InvalidStructureError)" href="#flatprot.io.errors.InvalidStructureError">InvalidStructureError</a></code>
              
              <div class="doc-md-description">
                <p>If the file is not a valid PDB or CIF format</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/io/structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">validate_structure_file</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate that the file exists and is a valid PDB or CIF format.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Path to the structure file</span>

<span class="sd">    Raises:</span>
<span class="sd">        StructureFileNotFoundError: If the file does not exist</span>
<span class="sd">        InvalidStructureError: If the file is not a valid PDB or CIF format</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check file existence</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">StructureFileNotFoundError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

    <span class="c1"># Check file extension</span>
    <span class="n">suffix</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">suffix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.pdb&quot;</span><span class="p">,</span> <span class="s2">&quot;.cif&quot;</span><span class="p">,</span> <span class="s2">&quot;.mmcif&quot;</span><span class="p">,</span> <span class="s2">&quot;.ent&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">InvalidStructureError</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span>
            <span class="s2">&quot;PDB or CIF&quot;</span><span class="p">,</span>
            <span class="s2">&quot;File does not have a recognized structure file extension (.pdb, .cif, .mmcif, .ent)&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Basic content validation</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># Read first 1000 bytes for quick check</span>

            <span class="c1"># Basic check for PDB format</span>
            <span class="k">if</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.pdb&quot;</span><span class="p">,</span> <span class="s2">&quot;.ent&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
                    <span class="s2">&quot;ATOM&quot;</span> <span class="ow">in</span> <span class="n">content</span> <span class="ow">or</span> <span class="s2">&quot;HETATM&quot;</span> <span class="ow">in</span> <span class="n">content</span> <span class="ow">or</span> <span class="s2">&quot;HEADER&quot;</span> <span class="ow">in</span> <span class="n">content</span>
                <span class="p">):</span>
                    <span class="k">raise</span> <span class="n">InvalidStructureError</span><span class="p">(</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span>
                        <span class="s2">&quot;PDB&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;File does not contain required PDB records (ATOM, HETATM, or HEADER)&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

            <span class="c1"># Basic check for mmCIF format</span>
            <span class="k">if</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.cif&quot;</span><span class="p">,</span> <span class="s2">&quot;.mmcif&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
                    <span class="s2">&quot;_atom_site.&quot;</span> <span class="ow">in</span> <span class="n">content</span> <span class="ow">or</span> <span class="s2">&quot;loop_&quot;</span> <span class="ow">in</span> <span class="n">content</span> <span class="ow">or</span> <span class="s2">&quot;data_&quot;</span> <span class="ow">in</span> <span class="n">content</span>
                <span class="p">):</span>
                    <span class="k">raise</span> <span class="n">InvalidStructureError</span><span class="p">(</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span>
                        <span class="s2">&quot;CIF&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;File does not contain required CIF categories (_atom_site, loop_, or data_)&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
    <span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidStructureError</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span>
            <span class="s2">&quot;PDB or CIF&quot;</span><span class="p">,</span>
            <span class="s2">&quot;File contains invalid characters and is not a valid text file&quot;</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><p>options:
show_root_heading: true</p>


<div class="doc doc-object doc-function">



<a id="flatprot.io.validate_optional_files"></a>
    <div class="doc doc-contents first">

        <p>Validate that optional files exist if specified.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>file_paths</code></b>
                  (<code><span title="typing.List">List</span>[<span title="typing.Optional">Optional</span>[<span title="pathlib.Path">Path</span>]]</code>)
              
              <div class="doc-md-description">
                <p>List of file paths to check (can include None values)</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="FileNotFoundError (flatprot.io.errors.FileNotFoundError)" href="#flatprot.io.errors.FileNotFoundError">FileNotFoundError</a></code>
              
              <div class="doc-md-description">
                <p>If any specified file does not exist</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/flatprot/io/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">validate_optional_files</span><span class="p">(</span>
    <span class="n">file_paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate that optional files exist if specified.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_paths: List of file paths to check (can include None values)</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If any specified file does not exist</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">file_paths</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><p>options:
show_root_heading: true</p>
<h2 id="io-errors">IO Errors</h2>
<p>Exceptions specific to file input, output, parsing, and validation.</p>


<div class="doc doc-object doc-module">



<a id="flatprot.io.errors"></a>
    <div class="doc doc-contents first">

        <p>Error classes for the FlatProt IO module.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.AnnotationError" class="doc doc-heading">
            <code>AnnotationError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="IOError (flatprot.io.errors.IOError)" href="#flatprot.io.errors.IOError">IOError</a></code></p>


        <p>Base class for annotation-related errors.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AnnotationError</span><span class="p">(</span><span class="ne">IOError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for annotation-related errors.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Annotation error: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.AnnotationFileError" class="doc doc-heading">
            <code>AnnotationFileError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AnnotationError (flatprot.io.errors.AnnotationError)" href="#flatprot.io.errors.AnnotationError">AnnotationError</a></code></p>


        <p>Exception raised when there's an issue with an annotation file.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AnnotationFileError</span><span class="p">(</span><span class="n">AnnotationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when there&#39;s an issue with an annotation file.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">details</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">details</span> <span class="o">=</span> <span class="n">details</span>

        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid annotation file: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">details</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">details</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">suggestion</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Annotation files should be in TOML format with an &#39;annotations&#39; list.&quot;</span>
        <span class="p">)</span>
        <span class="n">suggestion</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Example annotation format:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">suggestion</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        [[annotations]]</span>
<span class="s2">        type = &quot;point&quot;</span>
<span class="s2">        label = &quot;Active site&quot;</span>
<span class="s2">        chain = &quot;A&quot;</span>
<span class="s2">        indices = 123</span>
<span class="s2">        color = &quot;#FF0000&quot;</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="si">}{</span><span class="n">suggestion</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.AnnotationFileNotFoundError" class="doc doc-heading">
            <code>AnnotationFileNotFoundError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AnnotationError (flatprot.io.errors.AnnotationError)" href="#flatprot.io.errors.AnnotationError">AnnotationError</a></code></p>


        <p>Exception raised when an annotation file is not found.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AnnotationFileNotFoundError</span><span class="p">(</span><span class="n">AnnotationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when an annotation file is not found.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Annotation file not found: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.FileError" class="doc doc-heading">
            <code>FileError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="IOError (flatprot.io.errors.IOError)" href="#flatprot.io.errors.IOError">IOError</a></code></p>


        <p>Base class for file-related errors.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FileError</span><span class="p">(</span><span class="ne">IOError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for file-related errors.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.FileNotFoundError" class="doc doc-heading">
            <code>FileNotFoundError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FileError (flatprot.io.errors.FileError)" href="#flatprot.io.errors.FileError">FileError</a></code></p>


        <p>Exception raised when a required file is not found.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FileNotFoundError</span><span class="p">(</span><span class="n">FileError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a required file is not found.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;File not found: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">suggestion</span> <span class="o">=</span> <span class="s2">&quot;Please check that the file exists and the path is correct.&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">suggestion</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.IOError" class="doc doc-heading">
            <code>IOError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FlatProtError (flatprot.core.FlatProtError)" href="../core/#flatprot.core.errors.FlatProtError">FlatProtError</a></code></p>


        <p>Base class for all IO-related errors in FlatProt.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">IOError</span><span class="p">(</span><span class="n">FlatProtError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for all IO-related errors in FlatProt.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IO error: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.InvalidColorError" class="doc doc-heading">
            <code>InvalidColorError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StyleError (flatprot.io.errors.StyleError)" href="#flatprot.io.errors.StyleError">StyleError</a></code></p>


        <p>Exception raised when an invalid color is specified.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidColorError</span><span class="p">(</span><span class="n">StyleError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when an invalid color is specified.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color_value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">element_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_value</span> <span class="o">=</span> <span class="n">color_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span> <span class="o">=</span> <span class="n">element_type</span>

        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid color value &#39;</span><span class="si">{</span><span class="n">color_value</span><span class="si">}</span><span class="s2">&#39; for </span><span class="si">{</span><span class="n">element_type</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="n">suggestion</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Colors should be specified as hex (#RRGGBB), RGB (rgb(r,g,b)), or named colors.&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="si">}{</span><span class="n">suggestion</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.InvalidFieldTypeError" class="doc doc-heading">
            <code>InvalidFieldTypeError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AnnotationError (flatprot.io.errors.AnnotationError)" href="#flatprot.io.errors.AnnotationError">AnnotationError</a></code></p>


        <p>Exception raised when a field has an invalid type.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidFieldTypeError</span><span class="p">(</span><span class="n">AnnotationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a field has an invalid type.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">annotation_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">field_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">expected_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">annotation_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid type for field &#39;</span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2">&#39; in </span><span class="si">{</span><span class="n">annotation_type</span><span class="si">}</span><span class="s2"> annotation at index </span><span class="si">{</span><span class="n">annotation_index</span><span class="si">}</span><span class="s2">. Expected </span><span class="si">{</span><span class="n">expected_type</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.InvalidFileFormatError" class="doc doc-heading">
            <code>InvalidFileFormatError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FileError (flatprot.io.errors.FileError)" href="#flatprot.io.errors.FileError">FileError</a></code></p>


        <p>Exception raised when a file has an invalid format.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidFileFormatError</span><span class="p">(</span><span class="n">FileError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a file has an invalid format.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">expected_format</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expected_format</span> <span class="o">=</span> <span class="n">expected_format</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid file format for </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">. Expected </span><span class="si">{</span><span class="n">expected_format</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.InvalidMatrixDimensionsError" class="doc doc-heading">
            <code>InvalidMatrixDimensionsError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="MatrixError (flatprot.io.errors.MatrixError)" href="#flatprot.io.errors.MatrixError">MatrixError</a></code></p>


        <p>Error raised when a matrix has invalid dimensions.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidMatrixDimensionsError</span><span class="p">(</span><span class="n">MatrixError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Error raised when a matrix has invalid dimensions.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.InvalidMatrixError" class="doc doc-heading">
            <code>InvalidMatrixError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="MatrixError (flatprot.io.errors.MatrixError)" href="#flatprot.io.errors.MatrixError">MatrixError</a></code></p>


        <p>Exception raised when a matrix file has an invalid format.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidMatrixError</span><span class="p">(</span><span class="n">MatrixError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a matrix file has an invalid format.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">details</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">details</span> <span class="o">=</span> <span class="n">details</span>

        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid matrix file: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">details</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">details</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">suggestion</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Matrix files should be NumPy .npy files containing a 4x4 transformation matrix.&quot;</span>
        <span class="n">suggestion</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Alternatively, you can use separate .npy files for rotation (3x3) and translation (3x1).&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="si">}{</span><span class="n">suggestion</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.InvalidMatrixFormatError" class="doc doc-heading">
            <code>InvalidMatrixFormatError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="MatrixError (flatprot.io.errors.MatrixError)" href="#flatprot.io.errors.MatrixError">MatrixError</a></code></p>


        <p>Error raised when a matrix file has an invalid format.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidMatrixFormatError</span><span class="p">(</span><span class="n">MatrixError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Error raised when a matrix file has an invalid format.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.InvalidReferenceError" class="doc doc-heading">
            <code>InvalidReferenceError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AnnotationError (flatprot.io.errors.AnnotationError)" href="#flatprot.io.errors.AnnotationError">AnnotationError</a></code></p>


        <p>Exception raised when an annotation references a nonexistent chain or residue.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidReferenceError</span><span class="p">(</span><span class="n">AnnotationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when an annotation references a nonexistent chain or residue.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">annotation_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">reference_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">reference</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">annotation_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid </span><span class="si">{</span><span class="n">reference_type</span><span class="si">}</span><span class="s2"> reference &#39;</span><span class="si">{</span><span class="n">reference</span><span class="si">}</span><span class="s2">&#39; in </span><span class="si">{</span><span class="n">annotation_type</span><span class="si">}</span><span class="s2"> annotation at index </span><span class="si">{</span><span class="n">annotation_index</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.InvalidStructureError" class="doc doc-heading">
            <code>InvalidStructureError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StructureError (flatprot.io.errors.StructureError)" href="#flatprot.io.errors.StructureError">StructureError</a></code></p>


        <p>Exception raised when a structure file has an invalid format.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidStructureError</span><span class="p">(</span><span class="n">StructureError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a structure file has an invalid format.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">expected_format</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">details</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expected_format</span> <span class="o">=</span> <span class="n">expected_format</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">details</span> <span class="o">=</span> <span class="n">details</span>

        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid </span><span class="si">{</span><span class="n">expected_format</span><span class="si">}</span><span class="s2"> file: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">details</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">details</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">suggestion</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Please ensure the file is a valid </span><span class="si">{</span><span class="n">expected_format</span><span class="si">}</span><span class="s2"> format. &quot;</span>
        <span class="k">if</span> <span class="n">expected_format</span> <span class="o">==</span> <span class="s2">&quot;PDB&quot;</span><span class="p">:</span>
            <span class="n">suggestion</span> <span class="o">+=</span> <span class="s2">&quot;PDB files should contain ATOM, HETATM, or HEADER records.&quot;</span>
        <span class="k">elif</span> <span class="n">expected_format</span> <span class="o">==</span> <span class="s2">&quot;CIF&quot;</span><span class="p">:</span>
            <span class="n">suggestion</span> <span class="o">+=</span> <span class="s2">&quot;CIF files should contain _atom_site categories, loop_, or data_ sections.&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">suggestion</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.InvalidTomlError" class="doc doc-heading">
            <code>InvalidTomlError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StyleParsingError (flatprot.io.errors.StyleParsingError)" href="#flatprot.io.errors.StyleParsingError">StyleParsingError</a></code></p>


        <p>Error for malformed TOML files.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidTomlError</span><span class="p">(</span><span class="n">StyleParsingError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Error for malformed TOML files.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.MalformedAnnotationError" class="doc doc-heading">
            <code>MalformedAnnotationError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AnnotationError (flatprot.io.errors.AnnotationError)" href="#flatprot.io.errors.AnnotationError">AnnotationError</a></code></p>


        <p>Exception raised when an annotation file has an invalid format.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MalformedAnnotationError</span><span class="p">(</span><span class="n">AnnotationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when an annotation file has an invalid format.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">details</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Malformed annotation file: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">details</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.MatrixError" class="doc doc-heading">
            <code>MatrixError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="IOError (flatprot.io.errors.IOError)" href="#flatprot.io.errors.IOError">IOError</a></code></p>


        <p>Base class for matrix-related errors.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MatrixError</span><span class="p">(</span><span class="ne">IOError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for matrix-related errors.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matrix error: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.MatrixFileError" class="doc doc-heading">
            <code>MatrixFileError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="MatrixError (flatprot.io.errors.MatrixError)" href="#flatprot.io.errors.MatrixError">MatrixError</a></code></p>


        <p>Error raised when a matrix file can't be read.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MatrixFileError</span><span class="p">(</span><span class="n">MatrixError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Error raised when a matrix file can&#39;t be read.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.MatrixFileNotFoundError" class="doc doc-heading">
            <code>MatrixFileNotFoundError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="MatrixError (flatprot.io.errors.MatrixError)" href="#flatprot.io.errors.MatrixError">MatrixError</a></code></p>


        <p>Exception raised when a matrix file is not found.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MatrixFileNotFoundError</span><span class="p">(</span><span class="n">MatrixError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a matrix file is not found.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Matrix file not found: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.MissingRequiredFieldError" class="doc doc-heading">
            <code>MissingRequiredFieldError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AnnotationError (flatprot.io.errors.AnnotationError)" href="#flatprot.io.errors.AnnotationError">AnnotationError</a></code></p>


        <p>Exception raised when a required field is missing from an annotation.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MissingRequiredFieldError</span><span class="p">(</span><span class="n">AnnotationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a required field is missing from an annotation.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">annotation_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">field_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">annotation_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Missing required field &#39;</span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2">&#39; for </span><span class="si">{</span><span class="n">annotation_type</span><span class="si">}</span><span class="s2"> annotation at index </span><span class="si">{</span><span class="n">annotation_index</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.OutputError" class="doc doc-heading">
            <code>OutputError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="IOError (flatprot.io.errors.IOError)" href="#flatprot.io.errors.IOError">IOError</a></code></p>


        <p>Base class for output-related errors.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">OutputError</span><span class="p">(</span><span class="ne">IOError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for output-related errors.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output error: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.OutputFileError" class="doc doc-heading">
            <code>OutputFileError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="OutputError (flatprot.io.errors.OutputError)" href="#flatprot.io.errors.OutputError">OutputError</a></code></p>


        <p>Exception raised when there's an issue with an output file.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">OutputFileError</span><span class="p">(</span><span class="n">OutputError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when there&#39;s an issue with an output file.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">details</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">details</span> <span class="o">=</span> <span class="n">details</span>

        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error writing to output file: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">details</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">details</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">suggestion</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Please check that you have write permissions to the directory and sufficient disk space.&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="si">}{</span><span class="n">suggestion</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.StructureError" class="doc doc-heading">
            <code>StructureError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="IOError (flatprot.io.errors.IOError)" href="#flatprot.io.errors.IOError">IOError</a></code></p>


        <p>Base class for structure-related errors.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StructureError</span><span class="p">(</span><span class="ne">IOError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for structure-related errors.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Structure error: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.StructureFileNotFoundError" class="doc doc-heading">
            <code>StructureFileNotFoundError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StructureError (flatprot.io.errors.StructureError)" href="#flatprot.io.errors.StructureError">StructureError</a></code></p>


        <p>Exception raised when a structure file is not found.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StructureFileNotFoundError</span><span class="p">(</span><span class="n">StructureError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a structure file is not found.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Structure file not found: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">suggestion</span> <span class="o">=</span> <span class="s2">&quot;Please check that the file exists and the path is correct.&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">suggestion</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.StyleError" class="doc doc-heading">
            <code>StyleError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="IOError (flatprot.io.errors.IOError)" href="#flatprot.io.errors.IOError">IOError</a></code></p>


        <p>Base class for style-related errors.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StyleError</span><span class="p">(</span><span class="ne">IOError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for style-related errors.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Style error: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.StyleFileError" class="doc doc-heading">
            <code>StyleFileError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StyleError (flatprot.io.errors.StyleError)" href="#flatprot.io.errors.StyleError">StyleError</a></code></p>


        <p>Exception raised when there's an issue with a style file.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StyleFileError</span><span class="p">(</span><span class="n">StyleError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when there&#39;s an issue with a style file.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">details</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">details</span> <span class="o">=</span> <span class="n">details</span>

        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid style file: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">details</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">details</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">suggestion</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Style files should be in TOML format with sections for different elements.&quot;</span>
        <span class="n">suggestion</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Example style format:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">suggestion</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        [helix]</span>
<span class="s2">        fill_color = &quot;#FF0000&quot;</span>
<span class="s2">        stroke_color = &quot;#800000&quot;</span>

<span class="s2">        [sheet]</span>
<span class="s2">        fill_color = &quot;#00FF00&quot;</span>
<span class="s2">        stroke_color = &quot;#008000&quot;</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="si">}{</span><span class="n">suggestion</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.StyleFileNotFoundError" class="doc doc-heading">
            <code>StyleFileNotFoundError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StyleError (flatprot.io.errors.StyleError)" href="#flatprot.io.errors.StyleError">StyleError</a></code></p>


        <p>Exception raised when a style file is not found.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StyleFileNotFoundError</span><span class="p">(</span><span class="n">StyleError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a style file is not found.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Style file not found: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.StyleParsingError" class="doc doc-heading">
            <code>StyleParsingError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StyleError (flatprot.io.errors.StyleError)" href="#flatprot.io.errors.StyleError">StyleError</a></code></p>


        <p>Base error for style parsing issues.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StyleParsingError</span><span class="p">(</span><span class="n">StyleError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base error for style parsing issues.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="flatprot.io.errors.StyleValidationError" class="doc doc-heading">
            <code>StyleValidationError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StyleParsingError (flatprot.io.errors.StyleParsingError)" href="#flatprot.io.errors.StyleParsingError">StyleParsingError</a></code></p>


        <p>Error for invalid style field types or values.</p>







              <details class="quote">
                <summary>Source code in <code>src/flatprot/io/errors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StyleValidationError</span><span class="p">(</span><span class="n">StyleParsingError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Error for invalid style field types or values.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div><p>options:
show_root_heading: true</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../file_formats/annotations/" class="btn btn-neutral float-left" title="Annotation Files"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../core/" class="btn btn-neutral float-right" title="Core">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/t03i/FlatProt" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../../file_formats/annotations/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../core/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
